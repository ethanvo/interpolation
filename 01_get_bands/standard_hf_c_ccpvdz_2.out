#INFO: **** input file is /burg/berkelbach/users/eav2136/projects/interpolation/01_get_bands/df_hf_mp2.py ****
#!/usr/bin/env python
import numpy as np
from pyscf.pbc import gto, scf
from pyscf.pbc.tools import pyscf_ase, lattice, get_coulG
from pyscf.gto.basis import parse_nwchem
from pyscf import lib
from pyscf.pbc.lib.kpts_helper import get_kconserv, loop_kkk
from pyscf.pbc.df import df
from pyscf.ao2mo import _ao2mo
import h5py
import sys
from fileutils import load, dump

##############################
# Create a "Cell"
##############################

cell = gto.Cell()
# Candidate formula of solid: c, si, sic, bn, bp, aln, alp, mgo, mgs, lih, lif, licl
formula = "c"
ase_atom = lattice.get_ase_atom(formula)
cell.atom = pyscf_ase.ase_atoms_to_pyscf(ase_atom)
cell.a = ase_atom.cell[:]
cell.unit = 'B'
cell.basis = {'C': parse_nwchem.load("/burg/berkelbach/users/eav2136/builds/ccgto/basis/gth-hf-rev/cc-pvdz-lc.dat", 'C')}
cell.pseudo = "gth-hf-rev"
cell.verbose = 7
cell.build()

##############################
#  K-point SCF 
##############################
scf_mesh = int(sys.argv[1])
kmesh = [scf_mesh, scf_mesh, scf_mesh]
scaled_center=[0.0, 0.0, 0.0]
kpts = cell.make_kpts(kmesh, scaled_center=scaled_center)
mymf = scf.KRHF(cell, kpts=kpts, exxdiv="ewald")
ekrhf = mymf.kernel()

mo_energy = mymf.mo_energy
mo_coeff = mymf.mo_coeff
mo_energy = np.asarray(mo_energy)
mo_coeff = np.asarray(mo_coeff)

mydf = df.GDF(cell, kpts=kpts)
mydf.build()
nao = cell.nao_nr()
nocc = cell.nelectron // 2
nmo = mo_energy.shape[1]
nvir = nmo - nocc
nkpts = len(kpts)
kconserv = get_kconserv(cell, kpts)

mo_e_o = [mo_energy[k][:nocc] for k in range(nkpts)]
mo_e_v = [mo_energy[k][nocc:] for k in range(nkpts)]
emp2 = 0.0

Lov = np.empty((nkpts, nkpts), dtype=object)
bra_start = 0
bra_end = nocc
ket_start = nmo + nocc
ket_end = ket_start + nvir
with h5py.File(mydf._cderi, 'r') as f:
    kptij_lst = f['j3c-kptij'][:]
    tao = []
    ao_loc = None
    for ki, kpti in enumerate(kpts):
        for kj, kptj in enumerate(kpts):
            kpti_kptj = np.array((kpti, kptj))
            Lpq = np.asarray(df._getitem(f, 'j3c', kpti_kptj, kptij_lst))
            mo = np.hstack((mo_coeff[ki], mo_coeff[kj]))
            mo = np.asarray(mo, dtype=np.complex128, order='F')
            if Lpq[0].size != nao**2:
                Lpq = lib.unpack_tril(Lpq).astype(np.complex128)
            out = _ao2mo.r_e2(Lpq, mo, (bra_start, bra_end, ket_start, ket_end), tao, ao_loc)
            Lov[ki, kj] = out.reshape(-1, nocc, nvir)

for ki, kj, ka in loop_kkk(nkpts):
    kb = kconserv[ki, ka, kj]
    eia = mo_e_o[ki][:, None] - mo_e_v[ka]
    ejb = mo_e_o[kj][:, None] - mo_e_v[kb]
    eiajb = lib.direct_sum('ia,jb->iajb', eia, ejb)
    iajb = lib.einsum('Lia,Ljb->iajb', Lov[ki, ka], Lov[kj, kb]) / nkpts
    t2 = np.conj(iajb / eiajb)
    ibja = lib.einsum('Lib,Lja->ibja', Lov[ki, kb], Lov[kj, ka]) / nkpts
    emp2 += 2*lib.einsum('iajb,iajb', t2, iajb).real
    emp2 -=   lib.einsum('iajb,ibja', t2, ibja).real

emp2 /= nkpts
print("MP2 Correlation Energy: ", emp2)
total_energy = ekrhf + emp2

datafile = sys.argv[2]
datadict = {}
datadict['ekrhf'] = ekrhf
datadict['ekmp2'] = emp2
datadict['total_energy'] = total_energy
dump(datadict, f'data/{datafile}')
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='g067', release='4.18.0-193.el8.x86_64', version='#1 SMP Fri Mar 27 14:35:58 UTC 2020', machine='x86_64')  Threads 32
Python 3.10.12 (main, Jul 29 2023, 11:27:27) [GCC 13.2.0]
numpy 1.25.1  scipy 1.10.1
Date: Fri Nov 10 12:15:53 2023
PySCF version 2.0.1
PySCF path  /burg/berkelbach/users/eav2136/builds/pyscf/projected-cvs/pyscf
GIT HEAD (branch projected-cvs) 0bfbc692adf3ea63b8a509210433219cd1c472a2

[ENV] PYSCF_TMPDIR /burg/berkelbach/users/eav2136/projects/interpolation/01_get_bands/tmp
[ENV] PYSCF_MAX_MEMORY 187000
[CONFIG] DEBUG = False
[CONFIG] MAX_MEMORY = 187000
[CONFIG] TMPDIR = /burg/berkelbach/users/eav2136/projects/interpolation/01_get_bands/tmp
[CONFIG] UNIT = angstrom
[CONFIG] VERBOSE = 3
[CONFIG] conf_file = None
[INPUT] verbose = 7
[INPUT] max_memory = 187000 
[INPUT] num. atoms = 2
[INPUT] num. electrons = 8
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry False subgroup None
[INPUT] Mole.unit = B
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr
[INPUT]  2 C      0.891699936031   0.891699936031   0.891699936031 AA    1.685068664391   1.685068664391   1.685068664391 Bohr
[INPUT] ---------------- BASIS SET ---------------- 
[INPUT] l, kappa, [nprim/nctr], expnt,             c_1 c_2 ...
[INPUT] C
[INPUT] 0    0    [3    /1   ]  9.031436          -0.01960629
                                3.821255          -0.1291762
                                0.473725          0.5822572
[INPUT] 0    0    [1    /1   ]  0.149679             1
[INPUT] 1    0    [3    /1   ]  4.353457          0.08730943
                                1.266307          0.2797034
                                0.398715          0.5024424
[INPUT] 1    0    [1    /1   ]  0.124238             1
[INPUT] 2    0    [1    /1   ]  0.556013             1

Ewald components = 8.67997097708575e-26, -47.3756282134421, 34.5884981493536
nuclear repulsion = -12.7871300640885
number of shells = 10
number of NR pGTOs = 42
number of NR cGTOs = 26
basis = {'C': [[0, [9.031436, -0.01960629], [3.821255, -0.1291762], [0.473725, 0.5822572]], [0, [0.149679, 1.0]], [1, [4.353457, 0.08730943], [1.266307, 0.2797034], [0.398715, 0.5024424]], [1, [0.124238, 1.0]], [2, [0.556013, 1.0]]]}
ecp = {}
bas 0, expnt(s) = [9.031436 3.821255 0.473725]
bas 1, expnt(s) = [0.149679]
bas 2, expnt(s) = [4.353457 1.266307 0.398715]
bas 3, expnt(s) = [0.124238]
bas 4, expnt(s) = [0.556013]
bas 5, expnt(s) = [9.031436 3.821255 0.473725]
bas 6, expnt(s) = [0.149679]
bas 7, expnt(s) = [4.353457 1.266307 0.398715]
bas 8, expnt(s) = [0.124238]
bas 9, expnt(s) = [0.556013]
CPU time:         1.04
lattice vectors  a1 [0.000000000, 3.370137329, 3.370137329]
                 a2 [3.370137329, 0.000000000, 3.370137329]
                 a3 [3.370137329, 3.370137329, 0.000000000]
dimension = 3
low_dim_ft_type = None
Cell volume = 76.5549
rcut = 21.970857926874924 (nimgs = [6 6 6])
lattice sum = 1313 cells
precision = 1e-08
pseudo = gth-hf-rev
ke_cutoff = 382.86670519327265
    = [35 35 35] mesh (42875 PWs)


******** <class 'pyscf.pbc.scf.khf.KRHF'> ********
method = KRHF-KSCF-RHF-SCF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-07
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /burg/berkelbach/users/eav2136/projects/interpolation/01_get_bands/tmp/tmp9trxycpf
max_memory 187000 MB (current use 79 MB)


******** PBC SCF flags ********
N kpts = 8
kpts = [[ 0.          0.          0.        ]
 [ 0.46609268  0.46609268 -0.46609268]
 [ 0.46609268 -0.46609268  0.46609268]
 [ 0.93218535  0.          0.        ]
 [-0.46609268  0.46609268  0.46609268]
 [ 0.          0.93218535  0.        ]
 [ 0.          0.          0.93218535]
 [ 0.46609268  0.46609268  0.46609268]]
Exchange divergence treatment (exxdiv) = ewald
Monkhorst pack size [2 2 2] ew_eta 2.6874905281342873 ew_cut 2.619133378309657
Ewald components = 3.36744643244103e-288, -1.51660927211251, 1.34655455211594
    madelung (= occupied orbital energy shift) = 0.34010943999313437
    Total energy shift due to Ewald probe charge = -1/2 * Nelec*madelung = -1.36043775997
DF object = <pyscf.pbc.df.fft.FFTDF object at 0x155535fe3460>


******** <class 'pyscf.pbc.df.fft.FFTDF'> ********
mesh = [35 35 35] (42875 PWs)
len(kpts) = 8
    kpts = [[ 0.          0.          0.        ]
 [ 0.46609268  0.46609268 -0.46609268]
 [ 0.46609268 -0.46609268  0.46609268]
 [ 0.93218535  0.          0.        ]
 [-0.46609268  0.46609268  0.46609268]
 [ 0.          0.93218535  0.        ]
 [ 0.          0.          0.93218535]
 [ 0.46609268  0.46609268  0.46609268]]
Set gradient conv threshold to 0.000316228
Big error detected in the electron number of initial guess density matrix (Ne/cell = 8)!
  This can cause huge error in Fock matrix and lead to instability in SCF for low-dimensional systems.
  DM is normalized wrt the number of electrons 8.0
fft_jk: get_k_kpts max_memory 186198.285824  blksize 26
    CPU time for get_k_kpts: make_kpt (0,*)    185.70 sec, wall time      8.17 sec
    CPU time for get_k_kpts: make_kpt (1,*)    178.89 sec, wall time      8.00 sec
    CPU time for get_k_kpts: make_kpt (2,*)    189.98 sec, wall time      8.67 sec
    CPU time for get_k_kpts: make_kpt (3,*)    182.76 sec, wall time      8.17 sec
    CPU time for get_k_kpts: make_kpt (4,*)    186.14 sec, wall time      8.28 sec
    CPU time for get_k_kpts: make_kpt (5,*)    185.73 sec, wall time      8.23 sec
    CPU time for get_k_kpts: make_kpt (6,*)    180.93 sec, wall time      8.07 sec
    CPU time for get_k_kpts: make_kpt (7,*)    180.81 sec, wall time      8.07 sec
Monkhorst pack size [2 2 2] ew_eta 2.6874905281342873 ew_cut 2.619133378309657
Ewald components = 3.36744643244103e-288, -1.51660927211251, 1.34655455211594
    CPU time for vj and vk   1482.30 sec, wall time     66.10 sec
Ewald components = 8.67997097708575e-26, -47.3756282134421, 34.5884981493536
E1 = (4.897390316152445+7.883323585150625e-18j)  E_coul = (-1.6164482913264693+6.126325815632627e-16j)
init E= -9.50618803926253
cond(S) = [  26137.11707762  414733.50777788  414733.50778588 5364088.04624522
  414733.50780353 5364088.04619196 5364088.04627392  414733.50778571]
    CPU time for initialize scf   1494.64 sec, wall time     68.33 sec
HOMO = 0.679008899211  LUMO = 0.834854005208
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.88539426  0.6790089   0.6790089   0.6790089 ] [0.94001584 0.94001584 0.94001584 1.08736508 1.84248623 1.84248623
 2.03037178 2.13346726 2.13346726 2.13346726 2.75698479 2.75698479
 2.75698479 3.5917569  3.5917569  3.5917569  3.73085132 3.73085132
 4.79677229 4.79677229 4.79677229 5.23059366]
   1 ( 0.000  0.000  0.500)   [-0.52066908 -0.1529838   0.52211592  0.52211592] [ 0.93331416  1.07495366  1.07495366  1.51222943  1.68813935  1.87553893
  1.87553893  2.16038502  2.16038502  2.49077532  2.59747936  3.03523351
  3.14837325  3.14837325  3.18662353  3.18662353  3.72073852  3.72073852
  3.83328961  3.83328961  5.22742734 10.01170742]
   2 (-0.000  0.500  0.000)   [-0.52066908 -0.1529838   0.52211592  0.52211592] [ 0.93331416  1.07495366  1.07495366  1.51222943  1.68813935  1.87553893
  1.87553893  2.16038502  2.16038502  2.49077532  2.59747936  3.03523351
  3.14837325  3.14837325  3.18662353  3.18662353  3.72073852  3.72073852
  3.83328961  3.83328961  5.22742734 10.01170742]
   3 ( 0.000  0.500  0.500)   [-0.25735451 -0.25735451  0.32701123  0.32701123] [0.83485401 0.83485401 1.49885995 1.49885995 1.76183284 1.76183284
 2.11254659 2.11254659 2.35894441 2.35894441 2.87890146 2.87890146
 2.90122863 2.90122863 3.01466947 3.01466947 3.75656785 3.75656785
 5.11737502 5.11737502 7.08007112 7.08007112]
   4 ( 0.500 -0.000 -0.000)   [-0.52066908 -0.1529838   0.52211592  0.52211592] [ 0.93331416  1.07495366  1.07495366  1.51222943  1.68813935  1.87553893
  1.87553893  2.16038502  2.16038502  2.49077532  2.59747936  3.03523351
  3.14837325  3.14837325  3.18662353  3.18662353  3.72073852  3.72073852
  3.83328961  3.83328961  5.22742734 10.01170742]
   5 ( 0.500  0.000  0.500)   [-0.25735451 -0.25735451  0.32701123  0.32701123] [0.83485401 0.83485401 1.49885995 1.49885995 1.76183284 1.76183284
 2.11254659 2.11254659 2.35894441 2.35894441 2.87890146 2.87890146
 2.90122863 2.90122863 3.01466947 3.01466947 3.75656785 3.75656785
 5.11737502 5.11737502 7.08007112 7.08007112]
   6 ( 0.500  0.500  0.000)   [-0.25735451 -0.25735451  0.32701123  0.32701123] [0.83485401 0.83485401 1.49885995 1.49885995 1.76183284 1.76183284
 2.11254659 2.11254659 2.35894441 2.35894441 2.87890146 2.87890146
 2.90122863 2.90122863 3.01466947 3.01466947 3.75656785 3.75656785
 5.11737502 5.11737502 7.08007112 7.08007112]
   7 ( 0.500  0.500  0.500)   [-0.52066908 -0.1529838   0.52211592  0.52211592] [ 0.93331416  1.07495366  1.07495366  1.51222943  1.68813935  1.87553893
  1.87553893  2.16038502  2.16038502  2.49077532  2.59747936  3.03523351
  3.14837325  3.14837325  3.18662353  3.18662353  3.72073852  3.72073852
  3.83328961  3.83328961  5.22742734 10.01170742]
fft_jk: get_k_kpts max_memory 186116.025856  blksize 26
    CPU time for get_k_kpts: make_kpt (0,*)     33.39 sec, wall time      1.40 sec
    CPU time for get_k_kpts: make_kpt (1,*)     34.12 sec, wall time      1.44 sec
    CPU time for get_k_kpts: make_kpt (2,*)     32.83 sec, wall time      1.54 sec
    CPU time for get_k_kpts: make_kpt (3,*)     33.11 sec, wall time      1.38 sec
    CPU time for get_k_kpts: make_kpt (4,*)     33.40 sec, wall time      1.39 sec
    CPU time for get_k_kpts: make_kpt (5,*)     33.30 sec, wall time      1.40 sec
    CPU time for get_k_kpts: make_kpt (6,*)     33.08 sec, wall time      1.40 sec
    CPU time for get_k_kpts: make_kpt (7,*)     32.68 sec, wall time      1.40 sec
Monkhorst pack size [2 2 2] ew_eta 2.6874905281342873 ew_cut 2.619133378309657
Ewald components = 3.36744643244103e-288, -1.51660927211251, 1.34655455211594
    CPU time for vj and vk    276.96 sec, wall time     11.80 sec
Ewald components = 8.67997097708575e-26, -47.3756282134421, 34.5884981493536
E1 = (4.121922910871206+3.2087582677118704e-18j)  E_coul = (-2.2528608479993637+5.245685954421213e-16j)
cycle= 1 E= -10.9180680012167  delta_E= -1.41  |g|= 0.963  |ddm|=   23
    CPU time for cycle= 1    277.22 sec, wall time     13.39 sec
diis-norm(errvec)=1.87162
diis-c [-3.50295744+0.j  1.        +0.j]
HOMO = 0.343820528403  LUMO = 0.906696069217
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.68271724  0.34382053  0.34382053  0.34382053] [0.98089043 0.98089043 0.98089043 1.29992019 1.80147109 1.80147109
 2.06924585 2.1186669  2.1186669  2.1186669  2.70319598 2.70319598
 2.70319598 3.57290257 3.57290257 3.57290257 3.70500149 3.70500149
 4.76999447 4.76999447 4.76999447 5.2022338 ]
   1 ( 0.000  0.000  0.500)   [-0.4200473  -0.24958693  0.22545016  0.22545016] [1.0807101  1.09632975 1.09632975 1.51829268 1.66921047 1.84913201
 1.84913201 2.12182035 2.12182035 2.51071647 2.58291319 3.00265309
 3.1242345  3.1242345  3.12975744 3.12975744 3.70275371 3.70275371
 3.80247186 3.80247186 5.1707903  9.82641682]
   2 (-0.000  0.500  0.000)   [-0.4200473  -0.24958693  0.22545016  0.22545016] [1.0807101  1.09632975 1.09632975 1.51829268 1.66921047 1.84913201
 1.84913201 2.12182035 2.12182035 2.51071647 2.58291319 3.00265309
 3.1242345  3.1242345  3.12975744 3.12975744 3.70275371 3.70275371
 3.80247186 3.80247186 5.1707903  9.82641682]
   3 ( 0.000  0.500  0.500)   [-0.26085771 -0.26085771  0.07368086  0.07368086] [0.90669607 0.90669607 1.49894679 1.49894679 1.74550337 1.74550337
 2.06795404 2.06795404 2.32618163 2.32618163 2.83560337 2.83560337
 2.88965165 2.88965165 2.984988   2.984988   3.72391244 3.72391244
 5.08692587 5.08692587 6.99465358 6.99465358]
   4 ( 0.500 -0.000 -0.000)   [-0.4200473  -0.24958693  0.22545016  0.22545016] [1.0807101  1.09632975 1.09632975 1.51829268 1.66921047 1.84913201
 1.84913201 2.12182035 2.12182035 2.51071647 2.58291319 3.00265309
 3.1242345  3.1242345  3.12975744 3.12975744 3.70275371 3.70275371
 3.80247186 3.80247186 5.1707903  9.82641682]
   5 ( 0.500  0.000  0.500)   [-0.26085771 -0.26085771  0.07368086  0.07368086] [0.90669607 0.90669607 1.49894679 1.49894679 1.74550337 1.74550337
 2.06795404 2.06795404 2.32618163 2.32618163 2.83560337 2.83560337
 2.88965165 2.88965165 2.984988   2.984988   3.72391244 3.72391244
 5.08692587 5.08692588 6.99465358 6.99465358]
   6 ( 0.500  0.500  0.000)   [-0.26085771 -0.26085771  0.07368086  0.07368086] [0.90669607 0.90669607 1.49894679 1.49894679 1.74550337 1.74550337
 2.06795404 2.06795404 2.32618163 2.32618163 2.83560337 2.83560337
 2.88965165 2.88965165 2.984988   2.984988   3.72391244 3.72391244
 5.08692587 5.08692588 6.99465358 6.99465358]
   7 ( 0.500  0.500  0.500)   [-0.4200473  -0.24958693  0.22545016  0.22545016] [1.0807101  1.09632975 1.09632975 1.51829268 1.66921047 1.84913201
 1.84913201 2.12182035 2.12182035 2.51071647 2.58291319 3.00265309
 3.1242345  3.1242345  3.12975744 3.12975744 3.70275371 3.70275371
 3.80247186 3.80247186 5.1707903  9.82641682]
fft_jk: get_k_kpts max_memory 186076.33152  blksize 26
    CPU time for get_k_kpts: make_kpt (0,*)     32.50 sec, wall time      1.36 sec
    CPU time for get_k_kpts: make_kpt (1,*)     32.47 sec, wall time      1.37 sec
    CPU time for get_k_kpts: make_kpt (2,*)     32.98 sec, wall time      1.38 sec
    CPU time for get_k_kpts: make_kpt (3,*)     32.59 sec, wall time      1.37 sec
    CPU time for get_k_kpts: make_kpt (4,*)     33.46 sec, wall time      1.43 sec
    CPU time for get_k_kpts: make_kpt (5,*)     33.33 sec, wall time      1.45 sec
    CPU time for get_k_kpts: make_kpt (6,*)     33.00 sec, wall time      1.41 sec
    CPU time for get_k_kpts: make_kpt (7,*)     32.34 sec, wall time      1.40 sec
Monkhorst pack size [2 2 2] ew_eta 2.6874905281342873 ew_cut 2.619133378309657
Ewald components = 3.36744643244103e-288, -1.51660927211251, 1.34655455211594
    CPU time for vj and vk    273.73 sec, wall time     11.61 sec
Ewald components = 8.67997097708575e-26, -47.3756282134421, 34.5884981493536
E1 = (4.079395277588742-4.762752612688731e-19j)  E_coul = (-2.2462315011347935+5.278937652299523e-16j)
cycle= 2 E= -10.9539662876346  delta_E= -0.0359  |g|= 0.233  |ddm|= 27.3
    CPU time for cycle= 2    273.97 sec, wall time     12.87 sec
diis-norm(errvec)=0.599668
diis-c [-0.07371432+0.00000000e+00j -0.40594484+5.68393023e-31j
  1.40594484-5.68393023e-31j]
HOMO = 0.340014166182  LUMO = 0.912050013973
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.6782376   0.34001417  0.34001417  0.34001417] [0.98514015 0.98514015 0.98514015 1.32621304 1.80093251 1.80093251
 2.07137952 2.11855233 2.11855233 2.11855233 2.70430842 2.70430842
 2.70430842 3.57292405 3.57292405 3.57292405 3.70629996 3.70629996
 4.77125061 4.77125061 4.77125061 5.20607142]
   1 ( 0.000  0.000  0.500)   [-0.40867083 -0.25565077  0.22146235  0.22146235] [1.09853061 1.09861209 1.09861209 1.52346196 1.66990653 1.84967021
 1.84967021 2.1212243  2.1212243  2.5150094  2.58212464 3.00569037
 3.12492449 3.12492449 3.13276144 3.13276144 3.70314711 3.70314711
 3.8036636  3.8036636  5.17462946 9.83905106]
   2 (-0.000  0.500  0.000)   [-0.40867083 -0.25565077  0.22146235  0.22146235] [1.09853061 1.09861209 1.09861209 1.52346196 1.66990653 1.84967021
 1.84967021 2.1212243  2.1212243  2.5150094  2.58212464 3.00569037
 3.12492449 3.12492449 3.13276144 3.13276144 3.70314711 3.70314711
 3.8036636  3.8036636  5.17462946 9.83905106]
   3 ( 0.000  0.500  0.500)   [-0.2561203  -0.2561203   0.06847185  0.06847185] [0.91205001 0.91205001 1.50477886 1.50477886 1.74897735 1.74897735
 2.06525821 2.06525821 2.32673214 2.32673214 2.83763497 2.83763497
 2.89028417 2.89028417 2.98588101 2.98588101 3.72675009 3.72675009
 5.0884408  5.0884408  7.0017688  7.0017688 ]
   4 ( 0.500 -0.000 -0.000)   [-0.40867083 -0.25565077  0.22146235  0.22146235] [1.09853061 1.09861209 1.09861209 1.52346196 1.66990653 1.84967021
 1.84967021 2.1212243  2.1212243  2.5150094  2.58212464 3.00569037
 3.12492449 3.12492449 3.13276144 3.13276144 3.70314711 3.70314711
 3.8036636  3.8036636  5.17462946 9.83905106]
   5 ( 0.500  0.000  0.500)   [-0.2561203  -0.2561203   0.06847185  0.06847185] [0.91205001 0.91205001 1.50477886 1.50477886 1.74897735 1.74897735
 2.06525821 2.06525821 2.32673214 2.32673214 2.83763497 2.83763497
 2.89028417 2.89028417 2.98588101 2.98588101 3.72675009 3.72675009
 5.0884408  5.0884408  7.0017688  7.0017688 ]
   6 ( 0.500  0.500  0.000)   [-0.2561203  -0.2561203   0.06847185  0.06847185] [0.91205001 0.91205001 1.50477886 1.50477886 1.74897735 1.74897735
 2.06525821 2.06525821 2.32673214 2.32673214 2.83763497 2.83763497
 2.89028417 2.89028417 2.98588101 2.98588101 3.72675009 3.72675009
 5.0884408  5.0884408  7.0017688  7.0017688 ]
   7 ( 0.500  0.500  0.500)   [-0.40867083 -0.25565077  0.22146235  0.22146235] [1.09853061 1.09861209 1.09861209 1.52346196 1.66990653 1.84967021
 1.84967021 2.1212243  2.1212243  2.5150094  2.58212464 3.00569037
 3.12492449 3.12492449 3.13276144 3.13276144 3.70314711 3.70314711
 3.8036636  3.8036636  5.17462946 9.83905106]
fft_jk: get_k_kpts max_memory 186072.980992  blksize 26
    CPU time for get_k_kpts: make_kpt (0,*)     32.18 sec, wall time      1.36 sec
    CPU time for get_k_kpts: make_kpt (1,*)     32.37 sec, wall time      1.37 sec
    CPU time for get_k_kpts: make_kpt (2,*)     32.30 sec, wall time      1.39 sec
    CPU time for get_k_kpts: make_kpt (3,*)     32.68 sec, wall time      1.41 sec
    CPU time for get_k_kpts: make_kpt (4,*)     32.79 sec, wall time      1.45 sec
    CPU time for get_k_kpts: make_kpt (5,*)     32.78 sec, wall time      1.42 sec
    CPU time for get_k_kpts: make_kpt (6,*)     33.72 sec, wall time      1.46 sec
    CPU time for get_k_kpts: make_kpt (7,*)     33.97 sec, wall time      1.46 sec
Monkhorst pack size [2 2 2] ew_eta 2.6874905281342873 ew_cut 2.619133378309657
Ewald components = 3.36744643244103e-288, -1.51660927211251, 1.34655455211594
    CPU time for vj and vk    273.39 sec, wall time     11.74 sec
Ewald components = 8.67997097708575e-26, -47.3756282134421, 34.5884981493536
E1 = (4.080451551717891-3.988558725656908e-18j)  E_coul = (-2.2501798593854834+5.395409306770366e-16j)
cycle= 3 E= -10.9568583717561  delta_E= -0.00289  |g|= 0.0184  |ddm|= 20.3
    CPU time for cycle= 3    273.62 sec, wall time     12.65 sec
diis-norm(errvec)=0.0568197
diis-c [-1.55508884e-04+0.00000000e+00j  9.77956104e-02+1.93593841e-30j
 -3.52797577e-01-5.87337115e-30j  1.25500197e+00+3.93743274e-30j]
HOMO = 0.339269427986  LUMO = 0.910403556316
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.67886621  0.33926943  0.33926943  0.33926943] [0.98328893 0.98328893 0.98328893 1.32333694 1.80019135 1.80019135
 2.07110847 2.11768559 2.11768559 2.11768559 2.70242868 2.70242868
 2.70242868 3.57238139 3.57238139 3.57238139 3.7050449  3.7050449
 4.77011861 4.77011861 4.77011861 5.20462672]
   1 ( 0.000  0.000  0.500)   [-0.40901181 -0.25577807  0.22078808  0.22078808] [1.09628166 1.09701322 1.09701322 1.52067911 1.66850537 1.84836617
 1.84836617 2.12055806 2.12055806 2.51393705 2.58188642 3.00410757
 3.12417752 3.12417752 3.13058577 3.13058577 3.70252288 3.70252288
 3.8025204  3.8025204  5.17288116 9.83308158]
   2 (-0.000  0.500  0.000)   [-0.40901181 -0.25577807  0.22078808  0.22078808] [1.09628166 1.09701322 1.09701322 1.52067911 1.66850537 1.84836617
 1.84836617 2.12055806 2.12055806 2.51393705 2.58188642 3.00410757
 3.12417752 3.12417752 3.13058577 3.13058577 3.70252288 3.70252288
 3.8025204  3.8025204  5.17288116 9.83308158]
   3 ( 0.000  0.500  0.500)   [-0.25584997 -0.25584997  0.0677709   0.0677709 ] [0.91040356 0.91040356 1.50202346 1.50202346 1.74670613 1.74670613
 2.06483198 2.06483198 2.32595227 2.32595227 2.83603535 2.83603535
 2.88983986 2.88983986 2.98488979 2.98488979 3.7249665  3.7249665
 5.08740164 5.08740164 6.99866583 6.99866583]
   4 ( 0.500 -0.000 -0.000)   [-0.40901181 -0.25577807  0.22078808  0.22078808] [1.09628166 1.09701322 1.09701322 1.52067911 1.66850537 1.84836617
 1.84836617 2.12055806 2.12055806 2.51393705 2.58188642 3.00410757
 3.12417752 3.12417752 3.13058577 3.13058577 3.70252288 3.70252288
 3.8025204  3.8025204  5.17288116 9.83308158]
   5 ( 0.500  0.000  0.500)   [-0.25584997 -0.25584997  0.0677709   0.0677709 ] [0.91040356 0.91040356 1.50202346 1.50202346 1.74670613 1.74670613
 2.06483198 2.06483198 2.32595227 2.32595227 2.83603535 2.83603535
 2.88983986 2.88983986 2.98488979 2.98488979 3.7249665  3.7249665
 5.08740164 5.08740165 6.99866583 6.99866583]
   6 ( 0.500  0.500  0.000)   [-0.25584997 -0.25584997  0.0677709   0.0677709 ] [0.91040356 0.91040356 1.50202346 1.50202346 1.74670613 1.74670613
 2.06483198 2.06483198 2.32595227 2.32595227 2.83603535 2.83603535
 2.88983986 2.88983986 2.98488979 2.98488979 3.7249665  3.7249665
 5.08740164 5.08740165 6.99866583 6.99866583]
   7 ( 0.500  0.500  0.500)   [-0.40901181 -0.25577807  0.22078808  0.22078808] [1.09628166 1.09701322 1.09701322 1.52067911 1.66850537 1.84836617
 1.84836617 2.12055806 2.12055806 2.51393705 2.58188642 3.00410757
 3.12417752 3.12417752 3.13058577 3.13058577 3.70252288 3.70252288
 3.8025204  3.8025204  5.17288116 9.83308158]
fft_jk: get_k_kpts max_memory 186074.217984  blksize 26
    CPU time for get_k_kpts: make_kpt (0,*)     33.04 sec, wall time      1.40 sec
    CPU time for get_k_kpts: make_kpt (1,*)     32.91 sec, wall time      1.43 sec
    CPU time for get_k_kpts: make_kpt (2,*)     33.17 sec, wall time      1.39 sec
    CPU time for get_k_kpts: make_kpt (3,*)     33.29 sec, wall time      1.38 sec
    CPU time for get_k_kpts: make_kpt (4,*)     33.97 sec, wall time      1.43 sec
    CPU time for get_k_kpts: make_kpt (5,*)     32.88 sec, wall time      1.37 sec
    CPU time for get_k_kpts: make_kpt (6,*)     39.36 sec, wall time      1.67 sec
    CPU time for get_k_kpts: make_kpt (7,*)     33.00 sec, wall time      1.37 sec
Monkhorst pack size [2 2 2] ew_eta 2.6874905281342873 ew_cut 2.619133378309657
Ewald components = 3.36744643244103e-288, -1.51660927211251, 1.34655455211594
    CPU time for vj and vk    282.71 sec, wall time     11.84 sec
Ewald components = 8.67997097708575e-26, -47.3756282134421, 34.5884981493536
E1 = (4.081098521417044-3.786942801728956e-18j)  E_coul = (-2.25084039023888+5.300342819826954e-16j)
cycle= 4 E= -10.9568719329103  delta_E= -1.36e-05  |g|= 0.00158  |ddm|= 1.05
    CPU time for cycle= 4    282.95 sec, wall time     11.86 sec
diis-norm(errvec)=0.00260645
diis-c [-1.14028621e-06+1.12103877e-44j -1.27862473e-02-2.62545381e-29j
  4.51147385e-02+9.45145518e-29j -1.91502217e-01-3.29466473e-28j
  1.15917373e+00+2.61206459e-28j]
HOMO = 0.339433937349  LUMO = 0.910592633127
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.67893424  0.33943394  0.33943394  0.33943394] [0.98340204 0.98340204 0.98340204 1.32368031 1.80024644 1.80024644
 2.07116824 2.11775598 2.11775598 2.11775598 2.70268551 2.70268551
 2.70268551 3.572456   3.572456   3.572456   3.70517165 3.70517165
 4.77023872 4.77023872 4.77023872 5.20485619]
   1 ( 0.000  0.000  0.500)   [-0.40901371 -0.25593456  0.22088461  0.22088461] [1.09659748 1.09710782 1.09710782 1.52096439 1.66870417 1.84851973
 1.84851973 2.12065121 2.12065121 2.51407281 2.58192428 3.00430156
 3.12426212 3.12426212 3.13084204 3.13084204 3.70259788 3.70259788
 3.8026543  3.8026543  5.17314307 9.83391263]
   2 (-0.000  0.500  0.000)   [-0.40901371 -0.25593456  0.22088461  0.22088461] [1.09659748 1.09710782 1.09710782 1.52096439 1.66870417 1.84851973
 1.84851973 2.12065121 2.12065121 2.51407281 2.58192428 3.00430156
 3.12426212 3.12426212 3.13084204 3.13084204 3.70259788 3.70259788
 3.8026543  3.8026543  5.17314307 9.83391263]
   3 ( 0.000  0.500  0.500)   [-0.25600112 -0.25600112  0.06782284  0.06782284] [0.91059263 0.91059263 1.50229542 1.50229542 1.74700958 1.74700958
 2.06492411 2.06492411 2.32602701 2.32602701 2.83622362 2.83622362
 2.88988893 2.88988893 2.98501354 2.98501354 3.7251673  3.7251673
 5.08753235 5.08753236 6.99910545 6.99910545]
   4 ( 0.500 -0.000 -0.000)   [-0.40901371 -0.25593456  0.22088461  0.22088461] [1.09659748 1.09710782 1.09710782 1.52096439 1.66870417 1.84851973
 1.84851973 2.12065121 2.12065121 2.51407281 2.58192428 3.00430156
 3.12426212 3.12426212 3.13084204 3.13084204 3.70259788 3.70259788
 3.8026543  3.8026543  5.17314307 9.83391263]
   5 ( 0.500  0.000  0.500)   [-0.25600112 -0.25600112  0.06782284  0.06782284] [0.91059263 0.91059263 1.50229542 1.50229542 1.74700958 1.74700958
 2.06492411 2.06492411 2.32602701 2.32602701 2.83622362 2.83622362
 2.88988893 2.88988893 2.98501354 2.98501354 3.7251673  3.7251673
 5.08753235 5.08753236 6.99910545 6.99910545]
   6 ( 0.500  0.500  0.000)   [-0.25600112 -0.25600112  0.06782284  0.06782284] [0.91059263 0.91059263 1.50229542 1.50229542 1.74700958 1.74700958
 2.06492411 2.06492411 2.32602701 2.32602701 2.83622362 2.83622362
 2.88988893 2.88988893 2.98501354 2.98501354 3.7251673  3.7251673
 5.08753236 5.08753236 6.99910545 6.99910545]
   7 ( 0.500  0.500  0.500)   [-0.40901371 -0.25593456  0.22088461  0.22088461] [1.09659748 1.09710782 1.09710782 1.52096439 1.66870417 1.84851973
 1.84851973 2.12065121 2.12065121 2.51407281 2.58192428 3.00430156
 3.12426212 3.12426212 3.13084204 3.13084204 3.70259788 3.70259788
 3.8026543  3.8026543  5.17314307 9.83391263]
fft_jk: get_k_kpts max_memory 186073.476608  blksize 26
    CPU time for get_k_kpts: make_kpt (0,*)     33.19 sec, wall time      1.39 sec
    CPU time for get_k_kpts: make_kpt (1,*)     33.05 sec, wall time      1.38 sec
    CPU time for get_k_kpts: make_kpt (2,*)     33.24 sec, wall time      1.38 sec
    CPU time for get_k_kpts: make_kpt (3,*)     33.71 sec, wall time      1.40 sec
    CPU time for get_k_kpts: make_kpt (4,*)     34.82 sec, wall time      1.46 sec
    CPU time for get_k_kpts: make_kpt (5,*)     35.01 sec, wall time      1.48 sec
    CPU time for get_k_kpts: make_kpt (6,*)     36.12 sec, wall time      1.53 sec
    CPU time for get_k_kpts: make_kpt (7,*)     33.93 sec, wall time      1.42 sec
Monkhorst pack size [2 2 2] ew_eta 2.6874905281342873 ew_cut 2.619133378309657
Ewald components = 3.36744643244103e-288, -1.51660927211251, 1.34655455211594
    CPU time for vj and vk    284.25 sec, wall time     11.87 sec
Ewald components = 8.67997097708575e-26, -47.3756282134421, 34.5884981493536
E1 = (4.081051344631982-3.759459779672861e-18j)  E_coul = (-2.250793287012411+5.277681909026773e-16j)
cycle= 5 E= -10.9568720064689  delta_E= -7.36e-08  |g|= 0.000111  |ddm|= 0.145
    CPU time for cycle= 5    284.48 sec, wall time     11.91 sec
HOMO = 0.339428396519  LUMO = 0.910570781539
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.67891998  0.3394284   0.3394284   0.3394284 ] [0.98338793 0.98338793 0.98338793 1.32365061 1.80024048 1.80024048
 2.07116623 2.1177497  2.1177497  2.1177497  2.70266641 2.70266641
 2.70266641 3.57244957 3.57244957 3.57244957 3.70516004 3.70516004
 4.77022835 4.77022835 4.77022835 5.20484483]
   1 ( 0.000  0.000  0.500)   [-0.40900303 -0.2559121   0.22088272  0.22088272] [1.09656774 1.0970959  1.0970959  1.52093623 1.66868748 1.84850792
 1.84850792 2.12064313 2.12064313 2.51406208 2.58192203 3.00428611
 3.12425481 3.12425481 3.13082183 3.13082183 3.70259179 3.70259179
 3.80264313 3.80264313 5.17312801 9.83385996]
   2 (-0.000  0.500  0.000)   [-0.40900303 -0.2559121   0.22088272  0.22088272] [1.09656774 1.0970959  1.0970959  1.52093623 1.66868748 1.84850792
 1.84850792 2.12064313 2.12064313 2.51406208 2.58192203 3.00428611
 3.12425481 3.12425481 3.13082183 3.13082183 3.70259179 3.70259179
 3.80264313 3.80264313 5.17312801 9.83385996]
   3 ( 0.000  0.500  0.500)   [-0.25597472 -0.25597472  0.06782349  0.06782349] [0.91057078 0.91057078 1.50226924 1.50226924 1.74698337 1.74698337
 2.06491752 2.06491752 2.32602    2.32602    2.83620936 2.83620936
 2.8898848  2.8898848  2.98500371 2.98500371 3.72514978 3.72514978
 5.0875229  5.0875229  6.99907827 6.99907827]
   4 ( 0.500 -0.000 -0.000)   [-0.40900303 -0.2559121   0.22088272  0.22088272] [1.09656774 1.0970959  1.0970959  1.52093623 1.66868748 1.84850792
 1.84850792 2.12064313 2.12064313 2.51406208 2.58192203 3.00428611
 3.12425481 3.12425481 3.13082183 3.13082183 3.70259179 3.70259179
 3.80264313 3.80264313 5.17312801 9.83385996]
   5 ( 0.500  0.000  0.500)   [-0.25597472 -0.25597472  0.06782349  0.06782349] [0.91057078 0.91057078 1.50226924 1.50226924 1.74698337 1.74698337
 2.06491752 2.06491752 2.32602    2.32602    2.83620936 2.83620936
 2.8898848  2.8898848  2.98500371 2.98500371 3.72514978 3.72514978
 5.0875229  5.08752291 6.99907827 6.99907827]
   6 ( 0.500  0.500  0.000)   [-0.25597472 -0.25597472  0.06782349  0.06782349] [0.91057078 0.91057078 1.50226924 1.50226924 1.74698337 1.74698337
 2.06491752 2.06491752 2.32602    2.32602    2.83620936 2.83620936
 2.8898848  2.8898848  2.98500371 2.98500371 3.72514978 3.72514978
 5.0875229  5.08752291 6.99907827 6.99907827]
   7 ( 0.500  0.500  0.500)   [-0.40900303 -0.2559121   0.22088272  0.22088272] [1.09656774 1.0970959  1.0970959  1.52093623 1.66868748 1.84850792
 1.84850792 2.12064313 2.12064313 2.51406208 2.58192203 3.00428611
 3.12425481 3.12425481 3.13082183 3.13082183 3.70259179 3.70259179
 3.80264313 3.80264313 5.17312801 9.83385996]
fft_jk: get_k_kpts max_memory 186074.074624  blksize 26
    CPU time for get_k_kpts: make_kpt (0,*)     32.26 sec, wall time      1.36 sec
    CPU time for get_k_kpts: make_kpt (1,*)     32.53 sec, wall time      1.38 sec
    CPU time for get_k_kpts: make_kpt (2,*)     33.00 sec, wall time      1.39 sec
    CPU time for get_k_kpts: make_kpt (3,*)     33.61 sec, wall time      1.43 sec
    CPU time for get_k_kpts: make_kpt (4,*)     32.51 sec, wall time      1.40 sec
    CPU time for get_k_kpts: make_kpt (5,*)     35.24 sec, wall time      1.49 sec
    CPU time for get_k_kpts: make_kpt (6,*)     32.91 sec, wall time      1.41 sec
    CPU time for get_k_kpts: make_kpt (7,*)     33.19 sec, wall time      1.40 sec
Monkhorst pack size [2 2 2] ew_eta 2.6874905281342873 ew_cut 2.619133378309657
Ewald components = 3.36744643244103e-288, -1.51660927211251, 1.34655455211594
    CPU time for vj and vk    276.44 sec, wall time     11.92 sec
Ewald components = 8.67997097708575e-26, -47.3756282134421, 34.5884981493536
E1 = (4.081056464539497-3.762496078841392e-18j)  E_coul = (-2.250798407325847+5.304351764407387e-16j)
Extra cycle  E= -10.9568720068749  delta_E= -4.06e-10  |g|= 2.02e-05  |ddm|= 0.0161
    CPU time for scf_cycle   3163.57 sec, wall time    142.99 sec
    CPU time for SCF   3163.60 sec, wall time    143.12 sec
converged SCF energy = -10.9568720068749


******** <class 'pyscf.pbc.df.df.GDF'> ********
mesh = [7, 7, 7] (343 PWs)
auxbasis = None
eta = 0.2
exp_to_discard = None
_cderi_to_save = /burg/berkelbach/users/eav2136/projects/interpolation/01_get_bands/tmp/tmpryjj11jp
len(kpts) = 8
    kpts = [[ 0.          0.          0.        ]
 [ 0.46609268  0.46609268 -0.46609268]
 [ 0.46609268 -0.46609268  0.46609268]
 [ 0.93218535  0.          0.        ]
 [-0.46609268  0.46609268  0.46609268]
 [ 0.          0.93218535  0.        ]
 [ 0.          0.          0.93218535]
 [ 0.46609268  0.46609268  0.46609268]]
Even tempered Gaussians are generated as DF auxbasis for  C
  ETB auxbasis for C  [[0, [9.579456, 1]], [0, [4.789728, 1]], [0, [2.394864, 1]], [0, [1.197432, 1]], [0, [0.598716, 1]], [0, [0.299358, 1]], [1, [8.727455361661383, 1]], [1, [4.363727680830691, 1]], [1, [2.1818638404153456, 1]], [1, [1.0909319202076728, 1]], [1, [0.5454659601038364, 1]], [1, [0.2727329800519182, 1]], [2, [7.951232, 1]], [2, [3.975616, 1]], [2, [1.987808, 1]], [2, [0.993904, 1]], [2, [0.496952, 1]], [2, [0.248476, 1]], [3, [2.1026146480075707, 1]], [3, [1.0513073240037853, 1]], [3, [0.5256536620018927, 1]], [4, [1.112026, 1]]]
num shells = 44, num cGTOs = 168
Drop 0 primitive fitting functions
make aux basis, num shells = 44, num cGTOs = 168
auxcell.rcut 12.846608924246357
make compensating basis, num shells = 10, num cGTOs = 50
chgcell.rcut 11.482117703874595
    CPU time for 3c2e   1541.06 sec, wall time     69.91 sec
Num uniq kpts 14
uniq_kpts [[ 0.          0.          0.        ]
 [-0.46609268 -0.46609268  0.46609268]
 [-0.46609268  0.46609268 -0.46609268]
 [ 0.          0.93218535 -0.93218535]
 [-0.93218535  0.          0.        ]
 [ 0.46609268 -0.46609268 -0.46609268]
 [ 0.93218535  0.         -0.93218535]
 [ 0.93218535 -0.93218535  0.        ]
 [ 1.39827803 -0.46609268 -0.46609268]
 [ 0.         -0.93218535  0.        ]
 [ 0.46609268 -1.39827803  0.46609268]
 [ 0.          0.         -0.93218535]
 [ 0.46609268  0.46609268 -1.39827803]
 [-0.46609268 -0.46609268 -0.46609268]]
max_memory 185555.324416 (MB)  blocksize 21279280
Cholesky decomposition for j2c at kpt 0
Symmetry pattern (k - [0. 0. 0.])*a= 2n pi
    make_kpt for uniq_kptji_ids [0]
kpt = [0. 0. 0.]
adapted_ji_idx = [ 0  2  5  9 14 20 27 35]
memory = 1447.432192
int3c2e [1/1], AO [0:10], ncol = 351
Symmetry pattern (k + [0. 0. 0.])*a= 2n pi
    make_kpt for [0]
Cholesky decomposition for j2c at kpt 1
Symmetry pattern (k - [-0.46609268 -0.46609268  0.46609268])*a= 2n pi
    make_kpt for uniq_kptji_ids [1]
kpt = [-0.46609268 -0.46609268  0.46609268]
adapted_ji_idx = [ 1  8 19 34]
memory = 1605.65248
int3c2e [1/1], AO [0:10], ncol = 676
Symmetry pattern (k + [-0.46609268 -0.46609268  0.46609268])*a= 2n pi
    make_kpt for [1]
Cholesky decomposition for j2c at kpt 2
Symmetry pattern (k - [-0.46609268  0.46609268 -0.46609268])*a= 2n pi
    make_kpt for uniq_kptji_ids [2]
kpt = [-0.46609268  0.46609268 -0.46609268]
adapted_ji_idx = [ 3  7 25 33]
memory = 1706.717184
int3c2e [1/1], AO [0:10], ncol = 676
Symmetry pattern (k + [-0.46609268  0.46609268 -0.46609268])*a= 2n pi
    make_kpt for [2]
Cholesky decomposition for j2c at kpt 3
Symmetry pattern (k - [ 0.          0.93218535 -0.93218535])*a= 2n pi
    make_kpt for uniq_kptji_ids [3 4]
kpt = [ 0.          0.93218535 -0.93218535]
adapted_ji_idx = [ 4 26]
memory = 1736.78592
int3c2e [1/1], AO [0:10], ncol = 676
kpt = [-0.93218535  0.          0.        ]
adapted_ji_idx = [ 6 32]
memory = 1745.350656
int3c2e [1/1], AO [0:10], ncol = 676
Symmetry pattern (k + [ 0.          0.93218535 -0.93218535])*a= 2n pi
    make_kpt for [3 4]
Cholesky decomposition for j2c at kpt 5
Symmetry pattern (k - [ 0.46609268 -0.46609268 -0.46609268])*a= 2n pi
    make_kpt for uniq_kptji_ids [5]
kpt = [ 0.46609268 -0.46609268 -0.46609268]
adapted_ji_idx = [10 16 23 31]
memory = 1760.653312
int3c2e [1/1], AO [0:10], ncol = 676
Symmetry pattern (k + [ 0.46609268 -0.46609268 -0.46609268])*a= 2n pi
    make_kpt for [5]
Cholesky decomposition for j2c at kpt 6
Symmetry pattern (k - [ 0.93218535  0.         -0.93218535])*a= 2n pi
    make_kpt for uniq_kptji_ids [6 9]
kpt = [ 0.93218535  0.         -0.93218535]
adapted_ji_idx = [11 24]
memory = 1770.180608
int3c2e [1/1], AO [0:10], ncol = 676
kpt = [ 0.         -0.93218535  0.        ]
adapted_ji_idx = [15 30]
memory = 1779.761152
int3c2e [1/1], AO [0:10], ncol = 676
Symmetry pattern (k + [ 0.93218535  0.         -0.93218535])*a= 2n pi
    make_kpt for [6 9]
Cholesky decomposition for j2c at kpt 7
Symmetry pattern (k - [ 0.93218535 -0.93218535  0.        ])*a= 2n pi
    make_kpt for uniq_kptji_ids [ 7 11]
kpt = [ 0.93218535 -0.93218535  0.        ]
adapted_ji_idx = [12 18]
memory = 1786.056704
int3c2e [1/1], AO [0:10], ncol = 676
kpt = [ 0.          0.         -0.93218535]
adapted_ji_idx = [21 29]
memory = 1790.251008
int3c2e [1/1], AO [0:10], ncol = 676
Symmetry pattern (k + [ 0.93218535 -0.93218535  0.        ])*a= 2n pi
    make_kpt for [ 7 11]
Cholesky decomposition for j2c at kpt 8
Symmetry pattern (k - [ 1.39827803 -0.46609268 -0.46609268])*a= 2n pi
    make_kpt for uniq_kptji_ids [ 8 10 12 13]
kpt = [ 1.39827803 -0.46609268 -0.46609268]
adapted_ji_idx = [13]
memory = 1795.846144
int3c2e [1/1], AO [0:10], ncol = 676
kpt = [ 0.46609268 -1.39827803  0.46609268]
adapted_ji_idx = [17]
memory = 1798.176768
int3c2e [1/1], AO [0:10], ncol = 676
kpt = [ 0.46609268  0.46609268 -1.39827803]
adapted_ji_idx = [22]
memory = 1798.180864
int3c2e [1/1], AO [0:10], ncol = 676
kpt = [-0.46609268 -0.46609268 -0.46609268]
adapted_ji_idx = [28]
memory = 1798.180864
int3c2e [1/1], AO [0:10], ncol = 676
Symmetry pattern (k + [ 1.39827803 -0.46609268 -0.46609268])*a= 2n pi
    make_kpt for [ 8 10 12 13]
    CPU time for j3c   1631.57 sec, wall time     74.81 sec
MP2 Correlation Energy:  -0.23464370028898593
