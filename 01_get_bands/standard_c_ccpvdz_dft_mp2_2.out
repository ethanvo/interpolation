#INFO: **** input file is /Users/ethanvo/projects/interpolation/01_get_bands/standard_dft_mp2.py ****
#!/usr/bin/env python
import numpy as np
from pyscf.pbc import gto, dft, df
from pyscf.pbc.tools import pyscf_ase, lattice, get_coulG
from pyscf.gto.basis import parse_nwchem
from pyscf.pbc.mp.kmp2 import KRMP2
from pyscf import lib
import h5py
import sys
from fileutils import load, dump

##############################
# Create a "Cell"
##############################

cell = gto.Cell()
# Candidate formula of solid: c, si, sic, bn, bp, aln, alp, mgo, mgs, lih, lif, licl
formula = "c"
ase_atom = lattice.get_ase_atom(formula)
cell.atom = pyscf_ase.ase_atoms_to_pyscf(ase_atom)
cell.a = ase_atom.cell[:]
cell.unit = 'B'
cell.basis = {'C': parse_nwchem.load("/Users/ethanvo/builds/ccgto/basis/gth-hf-rev/cc-pvdz-lc.dat", 'C')}
cell.pseudo = "gth-hf-rev"
cell.verbose = 7
cell.build()

##############################
#  K-point SCF 
##############################
scf_mesh = int(sys.argv[1])
kmesh = [scf_mesh, scf_mesh, scf_mesh]
scaled_center=[0.0, 0.0, 0.0]
kpts = cell.make_kpts(kmesh, scaled_center=scaled_center)

mymf = dft.KRKS(cell, kpts=kpts)
mymf.xc = 'pbe'
ekrhf = mymf.kernel()

##############################
#  K-point MP2
##############################
mymp = KRMP2(mymf)
mydf = df.GDF(cell, kpts)
mymp._scf.with_df = mydf
mymp.with_df_ints = True
ekmp2, t2 = mymp.kernel()

total_energy = ekrhf + ekmp2
datafile = sys.argv[2]
datadict = {}
datadict['ekrhf'] = ekrhf
datadict['ekmp2'] = ekmp2
datadict['total_energy'] = total_energy
dump(datadict, f'data/{datafile}')
#INFO: ******************** input file end ********************


System: uname_result(system='Darwin', node='Concord-Dawn.local', release='23.1.0', version='Darwin Kernel Version 23.1.0: Mon Oct  9 21:27:24 PDT 2023; root:xnu-10002.41.9~6/RELEASE_ARM64_T6000', machine='arm64')  Threads 10
Python 3.11.5 (main, Aug 24 2023, 15:09:45) [Clang 14.0.3 (clang-1403.0.22.14.1)]
numpy 1.26.0  scipy 1.10.1
Date: Tue Nov  7 14:49:42 2023
PySCF version 2.0.1
PySCF path  /Users/ethanvo/builds/pyscf/projected_cvs/pyscf
GIT ORIG_HEAD 39249f5012c1a95ee10ab9573a362ed9ef07a422
GIT HEAD (branch projected-cvs) 12799a671021ff0b92a23c4db7c36e2a9239ed2d

[ENV] PYSCF_MAX_MEMORY 64000
[ENV] PYSCF_TMPDIR /Users/ethanvo/projects/interpolation/01_get_bands/tmp
[CONFIG] DEBUG = False
[CONFIG] MAX_MEMORY = 64000
[CONFIG] TMPDIR = /Users/ethanvo/projects/interpolation/01_get_bands/tmp
[CONFIG] UNIT = angstrom
[CONFIG] VERBOSE = 3
[CONFIG] conf_file = None
[INPUT] verbose = 7
[INPUT] max_memory = 64000 
[INPUT] num. atoms = 2
[INPUT] num. electrons = 8
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry False subgroup None
[INPUT] Mole.unit = B
[INPUT]  1 C      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr
[INPUT]  2 C      0.891699936031   0.891699936031   0.891699936031 AA    1.685068664391   1.685068664391   1.685068664391 Bohr
[INPUT] ---------------- BASIS SET ---------------- 
[INPUT] l, kappa, [nprim/nctr], expnt,             c_1 c_2 ...
[INPUT] C
[INPUT] 0    0    [3    /1   ]  9.031436          -0.01960629
                                3.821255          -0.1291762
                                0.473725          0.5822572
[INPUT] 0    0    [1    /1   ]  0.149679             1
[INPUT] 1    0    [3    /1   ]  4.353457          0.08730943
                                1.266307          0.2797034
                                0.398715          0.5024424
[INPUT] 1    0    [1    /1   ]  0.124238             1
[INPUT] 2    0    [1    /1   ]  0.556013             1

Ewald components = 8.67997097708575e-26, -47.3756282134421, 34.5884981493536
nuclear repulsion = -12.7871300640885
number of shells = 10
number of NR pGTOs = 42
number of NR cGTOs = 26
basis = {'C': [[0, [9.031436, -0.01960629], [3.821255, -0.1291762], [0.473725, 0.5822572]], [0, [0.149679, 1.0]], [1, [4.353457, 0.08730943], [1.266307, 0.2797034], [0.398715, 0.5024424]], [1, [0.124238, 1.0]], [2, [0.556013, 1.0]]]}
ecp = {}
bas 0, expnt(s) = [9.031436 3.821255 0.473725]
bas 1, expnt(s) = [0.149679]
bas 2, expnt(s) = [4.353457 1.266307 0.398715]
bas 3, expnt(s) = [0.124238]
bas 4, expnt(s) = [0.556013]
bas 5, expnt(s) = [9.031436 3.821255 0.473725]
bas 6, expnt(s) = [0.149679]
bas 7, expnt(s) = [4.353457 1.266307 0.398715]
bas 8, expnt(s) = [0.124238]
bas 9, expnt(s) = [0.556013]
CPU time:         0.25
lattice vectors  a1 [0.000000000, 3.370137329, 3.370137329]
                 a2 [3.370137329, 0.000000000, 3.370137329]
                 a3 [3.370137329, 3.370137329, 0.000000000]
dimension = 3
low_dim_ft_type = None
Cell volume = 76.5549
rcut = 21.970857926874924 (nimgs = [6 6 6])
lattice sum = 1313 cells
precision = 1e-08
pseudo = gth-hf-rev
ke_cutoff = 382.8667051932727
    = [35 35 35] mesh (42875 PWs)


******** <class 'pyscf.pbc.dft.krks.KRKS'> ********
method = KRKS-KohnShamDFT
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-07
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /Users/ethanvo/projects/interpolation/01_get_bands/tmp/tmpyscyfuqj
max_memory 64000 MB (current use 0 MB)


******** PBC SCF flags ********
N kpts = 8
kpts = [[ 0.          0.          0.        ]
 [ 0.46609268  0.46609268 -0.46609268]
 [ 0.46609268 -0.46609268  0.46609268]
 [ 0.93218535  0.          0.        ]
 [-0.46609268  0.46609268  0.46609268]
 [ 0.          0.93218535  0.        ]
 [ 0.          0.          0.93218535]
 [ 0.46609268  0.46609268  0.46609268]]
Exchange divergence treatment (exxdiv) = ewald
Monkhorst pack size [2 2 2] ew_eta 2.6874905281342873 ew_cut 2.619133378309657
Ewald components = 3.36744643244103e-288, -1.51660927211251, 1.34655455211594
    madelung (= occupied orbital energy shift) = 0.3401094399931348
    Total energy shift due to Ewald probe charge = -1/2 * Nelec*madelung = -1.36043775997
DF object = <pyscf.pbc.df.fft.FFTDF object at 0x1064cdd90>


******** <class 'pyscf.pbc.df.fft.FFTDF'> ********
mesh = [35 35 35] (42875 PWs)
len(kpts) = 8
    kpts = [[ 0.          0.          0.        ]
 [ 0.46609268  0.46609268 -0.46609268]
 [ 0.46609268 -0.46609268  0.46609268]
 [ 0.93218535  0.          0.        ]
 [-0.46609268  0.46609268  0.46609268]
 [ 0.          0.93218535  0.        ]
 [ 0.          0.          0.93218535]
 [ 0.46609268  0.46609268  0.46609268]]
XC functionals = pbe
small_rho_cutoff = 1e-07
Uniform grid, mesh = [35 35 35]
Set gradient conv threshold to 0.000316228
Big error detected in the electron number of initial guess density matrix (Ne/cell = 8)!
  This can cause huge error in Fock matrix and lead to instability in SCF for low-dimensional systems.
  DM is normalized wrt the number of electrons 8.0
    CPU time for setting up grids      0.55 sec, wall time      0.10 sec
nelec by numeric integration = 8.000000000000002
    CPU time for vxc      1.60 sec, wall time      0.24 sec
    CPU time for vj and vk      1.47 sec, wall time      0.21 sec
Ewald components = 8.67997097708575e-26, -47.3756282134421, 34.5884981493536
E1 = (4.89739031615245-1.6914137304238266e-17j)  Ecoul = 1.538119234182489  Exc = -3.7997002055404177
init E= -10.151320719294
cond(S) = [  26137.1170775   414733.50778054  414733.50779911 5364088.04453874
  414733.50776296 5364088.04493495 5364088.04551413  414733.50777889]
    CPU time for initialize scf      5.19 sec, wall time      0.89 sec
HOMO = 0.572136254758  LUMO = 0.708460626724
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.24766312  0.57213625  0.57213625  0.57213625] [0.75903983 0.75903983 0.75903983 1.0472349  1.52268223 1.52268223
 1.80183809 1.80183809 1.80183809 1.8249933  2.34502025 2.34502025
 2.34502025 3.2065251  3.2065251  3.2065251  3.29662861 3.29662861
 4.35521321 4.35521321 4.35521321 4.95478388]
   1 ( 0.000  0.000  0.500)   [-0.02955725  0.04939761  0.46217819  0.46217819] [0.86181625 0.86181625 0.8763769  1.21755383 1.38923471 1.55354224
 1.55354224 1.82014486 1.82014486 2.18603858 2.26453481 2.64419074
 2.7472774  2.7472774  2.76273354 2.76273354 3.3406983  3.3406983
 3.4051255  3.4051255  4.8972671  9.61041302]
   2 (-0.000  0.500  0.000)   [-0.02955725  0.04939761  0.46217819  0.46217819] [0.86181625 0.86181625 0.8763769  1.21755383 1.38923471 1.55354224
 1.55354224 1.82014486 1.82014486 2.18603858 2.26453481 2.64419074
 2.7472774  2.7472774  2.76273354 2.76273354 3.3406983  3.3406983
 3.4051255  3.4051255  4.8972671  9.61041302]
   3 ( 0.000  0.500  0.500)   [0.07891487 0.0789151  0.32469329 0.32469329] [0.70846063 0.70846078 1.20080592 1.20080592 1.44587552 1.44587882
 1.78322506 1.78322506 2.00216987 2.00216987 2.47905088 2.47905088
 2.55478229 2.5547824  2.61830289 2.61830289 3.31419484 3.3141954
 4.68640737 4.68640737 6.72571155 6.72585252]
   4 ( 0.500 -0.000 -0.000)   [-0.02955725  0.04939761  0.46217819  0.46217819] [0.86181625 0.86181625 0.8763769  1.21755383 1.38923471 1.55354224
 1.55354224 1.82014486 1.82014486 2.18603858 2.26453481 2.64419074
 2.7472774  2.7472774  2.76273354 2.76273354 3.3406983  3.3406983
 3.4051255  3.4051255  4.8972671  9.61041302]
   5 ( 0.500  0.000  0.500)   [0.07891487 0.0789151  0.32469329 0.32469329] [0.70846063 0.70846078 1.20080592 1.20080592 1.44587552 1.44587882
 1.78322506 1.78322506 2.00216987 2.00216987 2.47905088 2.47905088
 2.55478229 2.5547824  2.61830289 2.61830289 3.31419484 3.3141954
 4.68640737 4.68640737 6.72571155 6.72585252]
   6 ( 0.500  0.500  0.000)   [0.07891487 0.0789151  0.32469329 0.32469329] [0.70846063 0.70846078 1.20080592 1.20080592 1.44587552 1.44587882
 1.78322506 1.78322506 2.00216987 2.00216987 2.47905088 2.47905088
 2.55478229 2.5547824  2.61830289 2.61830289 3.31419484 3.3141954
 4.68640737 4.68640737 6.72571155 6.72585252]
   7 ( 0.500  0.500  0.500)   [-0.02955725  0.04939761  0.46217819  0.46217819] [0.86181625 0.86181625 0.8763769  1.21755383 1.38923471 1.55354224
 1.55354224 1.82014486 1.82014486 2.18603858 2.26453481 2.64419074
 2.7472774  2.7472774  2.76273354 2.76273354 3.3406983  3.3406983
 3.4051255  3.4051255  4.8972671  9.61041302]
nelec by numeric integration = 8.000000000000007
    CPU time for vxc      1.59 sec, wall time      0.25 sec
    CPU time for vj and vk      1.42 sec, wall time      0.20 sec
Ewald components = 8.67997097708575e-26, -47.3756282134421, 34.5884981493536
E1 = (4.116791616080952+8.51682074583738e-17j)  Ecoul = 0.9923036950980926  Exc = -3.5681714215823765
cycle= 1 E= -11.2462061744918  delta_E= -1.09  |g|= 0.407  |ddm|= 90.7
    CPU time for cycle= 1      3.02 sec, wall time      0.46 sec
diis-norm(errvec)=0.586522
diis-c [-0.34400834+1.54074396e-33j  1.        +0.00000000e+00j]
HOMO = 0.498071597388  LUMO = 0.67095060168
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.29466249  0.4980716   0.4980716   0.4980716 ] [0.7031895  0.7031895  0.7031895  0.97882764 1.48992734 1.48992734
 1.75571629 1.75571629 1.75571629 1.7813732  2.26659001 2.26659001
 2.26659001 3.16776723 3.16776723 3.16776723 3.25779742 3.25779742
 4.3103938  4.3103938  4.3103938  4.85307259]
   1 ( 0.000  0.000  0.500)   [-0.08352077  0.00321962  0.39415235  0.39415235] [0.8092034  0.8092034  0.81900354 1.13705146 1.32023342 1.49706329
 1.49706329 1.78473089 1.78473089 2.14123941 2.22704295 2.58825513
 2.67134145 2.67134145 2.71953345 2.71953345 3.29452106 3.29452106
 3.36139323 3.36139323 4.78953531 9.36243426]
   2 (-0.000  0.500  0.000)   [-0.08352077  0.00321962  0.39415235  0.39415235] [0.8092034  0.8092034  0.81900354 1.13705146 1.32023342 1.49706329
 1.49706329 1.78473089 1.78473089 2.14123941 2.22704295 2.58825513
 2.67134145 2.67134145 2.71953345 2.71953345 3.29452106 3.29452106
 3.36139323 3.36139323 4.78953531 9.36243426]
   3 ( 0.000  0.500  0.500)   [0.02466783 0.02466876 0.26540409 0.26540409] [0.6709506  0.67095103 1.11806288 1.11806288 1.36575384 1.36575446
 1.7362691  1.7362691  1.96763719 1.96763834 2.41533251 2.41533251
 2.5159115  2.51591268 2.57419627 2.57419627 3.26566272 3.265665
 4.63589509 4.63589509 6.58071053 6.58213927]
   4 ( 0.500 -0.000 -0.000)   [-0.08352077  0.00321962  0.39415235  0.39415235] [0.8092034  0.8092034  0.81900354 1.13705146 1.32023342 1.49706329
 1.49706329 1.78473089 1.78473089 2.14123941 2.22704295 2.58825513
 2.67134145 2.67134145 2.71953345 2.71953345 3.29452106 3.29452106
 3.36139323 3.36139323 4.7895353  9.36243426]
   5 ( 0.500  0.000  0.500)   [0.02466783 0.02466876 0.26540409 0.26540409] [0.6709506  0.67095103 1.11806288 1.11806288 1.36575384 1.36575446
 1.7362691  1.7362691  1.96763719 1.96763834 2.41533251 2.41533251
 2.5159115  2.51591268 2.57419627 2.57419627 3.26566272 3.265665
 4.63589509 4.63589509 6.58071053 6.58213927]
   6 ( 0.500  0.500  0.000)   [0.02466783 0.02466876 0.26540409 0.26540409] [0.6709506  0.67095103 1.11806288 1.11806288 1.36575384 1.36575446
 1.7362691  1.7362691  1.96763719 1.96763834 2.41533251 2.41533251
 2.5159115  2.51591268 2.57419627 2.57419627 3.26566272 3.265665
 4.63589509 4.63589509 6.58071053 6.58213927]
   7 ( 0.500  0.500  0.500)   [-0.08352077  0.00321962  0.39415235  0.39415235] [0.8092034  0.8092034  0.81900354 1.13705146 1.32023342 1.49706329
 1.49706329 1.78473089 1.78473089 2.14123941 2.22704295 2.58825513
 2.67134145 2.67134145 2.71953345 2.71953345 3.29452106 3.29452106
 3.36139323 3.36139323 4.78953531 9.36243426]
nelec by numeric integration = 8.000000000000156
    CPU time for vxc      1.59 sec, wall time      0.25 sec
    CPU time for vj and vk      1.40 sec, wall time      0.20 sec
Ewald components = 8.67997097708575e-26, -47.3756282134421, 34.5884981493536
E1 = (4.052894251832233+3.0697846402013766e-17j)  Ecoul = 1.0863593281110895  Exc = -3.603089674542638
cycle= 2 E= -11.2509661586878  delta_E= -0.00476  |g|= 0.0827  |ddm|= 59.7
    CPU time for cycle= 2      3.00 sec, wall time      0.46 sec
diis-norm(errvec)=0.125673
diis-c [-1.22684173e-04+4.93191802e-34j  1.75918438e-01+1.16383868e-32j
  8.24081562e-01-1.16383868e-32j]
HOMO = 0.509279371361  LUMO = 0.676034431532
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.28777741  0.50927937  0.50927937  0.50927937] [0.71163369 0.71163369 0.71163369 0.9900568  1.49383738 1.49383738
 1.7608868  1.7608868  1.7608868  1.78606492 2.27663731 2.27663731
 2.27663731 3.17337687 3.17337687 3.17337687 3.26397055 3.26397055
 4.31733217 4.31733217 4.31733217 4.86208841]
   1 ( 0.000  0.000  0.500)   [-0.07528191  0.0098135   0.40443817  0.40443817] [0.81700166 0.81700166 0.82798379 1.14930665 1.32929239 1.50393889
 1.50393889 1.78950636 1.78950636 2.14726106 2.2313086  2.59636265
 2.68116764 2.68116764 2.72555667 2.72555667 3.30047913 3.30047913
 3.36794108 3.36794108 4.79991416 9.38522142]
   2 (-0.000  0.500  0.000)   [-0.07528191  0.0098135   0.40443817  0.40443817] [0.81700166 0.81700166 0.82798379 1.14930665 1.32929239 1.50393889
 1.50393889 1.78950636 1.78950636 2.14726106 2.2313086  2.59636265
 2.68116764 2.68116764 2.72555667 2.72555667 3.30047913 3.30047913
 3.36794108 3.36794108 4.79991416 9.38522142]
   3 ( 0.000  0.500  0.500)   [0.03285481 0.03285511 0.27422969 0.27422969] [0.67603443 0.67603445 1.13077863 1.13077863 1.37678087 1.37678502
 1.74207478 1.74207478 1.97206758 1.97206853 2.42355834 2.42355834
 2.52107799 2.52107845 2.58027595 2.58027595 3.27373408 3.27373783
 4.6429785  4.6429785  6.59407506 6.59558307]
   4 ( 0.500 -0.000 -0.000)   [-0.07528191  0.0098135   0.40443817  0.40443817] [0.81700166 0.81700166 0.82798379 1.14930665 1.32929239 1.50393889
 1.50393889 1.78950636 1.78950636 2.14726106 2.2313086  2.59636265
 2.68116764 2.68116764 2.72555667 2.72555667 3.30047913 3.30047913
 3.36794108 3.36794108 4.79991416 9.38522142]
   5 ( 0.500  0.000  0.500)   [0.03285481 0.03285511 0.27422969 0.27422969] [0.67603443 0.67603445 1.13077863 1.13077863 1.37678087 1.37678502
 1.74207478 1.74207478 1.97206758 1.97206853 2.42355834 2.42355834
 2.52107799 2.52107845 2.58027595 2.58027595 3.27373408 3.27373783
 4.6429785  4.6429785  6.59407506 6.59558307]
   6 ( 0.500  0.500  0.000)   [0.03285481 0.03285511 0.27422969 0.27422969] [0.67603443 0.67603445 1.13077863 1.13077863 1.37678087 1.37678502
 1.74207478 1.74207478 1.97206758 1.97206853 2.42355834 2.42355834
 2.52107799 2.52107845 2.58027595 2.58027595 3.27373408 3.27373783
 4.6429785  4.6429785  6.59407506 6.59558307]
   7 ( 0.500  0.500  0.500)   [-0.07528191  0.0098135   0.40443817  0.40443817] [0.81700166 0.81700166 0.82798379 1.14930665 1.32929239 1.50393889
 1.50393889 1.78950636 1.78950636 2.14726106 2.2313086  2.59636265
 2.68116764 2.68116764 2.72555667 2.72555667 3.30047913 3.30047913
 3.36794108 3.36794108 4.79991416 9.38522142]
nelec by numeric integration = 8.00000000000013
    CPU time for vxc      1.59 sec, wall time      0.25 sec
    CPU time for vj and vk      1.41 sec, wall time      0.20 sec
Ewald components = 8.67997097708575e-26, -47.3756282134421, 34.5884981493536
E1 = (4.062900588589098+3.83278399774197e-17j)  Ecoul = 1.0700103552178284  Exc = -3.5969552312044906
cycle= 3 E= -11.2511743514861  delta_E= -0.000208  |g|= 0.000784  |ddm|= 7.91
    CPU time for cycle= 3      3.01 sec, wall time      0.45 sec
diis-norm(errvec)=0.00146734
diis-c [-3.70243227e-08-2.69126545e-36j -3.33136748e-03-6.74261375e-30j
 -2.72714569e-02-3.15377361e-29j  1.03060282e+00+3.82803499e-29j]
HOMO = 0.509320497094  LUMO = 0.675999469661
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.287772   0.5093205  0.5093205  0.5093205] [0.71165991 0.71165991 0.71165991 0.99009903 1.49383526 1.49383526
 1.76084842 1.76084842 1.76084842 1.78595497 2.27664027 2.27664027
 2.27664027 3.17335792 3.17335792 3.17335792 3.26399346 3.26399346
 4.31733236 4.31733236 4.31733236 4.86197175]
   1 ( 0.000  0.000  0.500)   [-0.07525641  0.009809    0.40447475  0.40447475] [0.81701656 0.81701656 0.82800112 1.14934277 1.32924357 1.50391783
 1.50391783 1.78950796 1.78950796 2.14724327 2.23124633 2.596366
 2.6811853  2.6811853  2.7255499  2.7255499  3.30042261 3.30042261
 3.36795309 3.36795309 4.79981922 9.3852178 ]
   2 (-0.000  0.500  0.000)   [-0.07525641  0.009809    0.40447475  0.40447475] [0.81701656 0.81701656 0.82800112 1.14934277 1.32924357 1.50391783
 1.50391783 1.78950796 1.78950796 2.14724327 2.23124633 2.596366
 2.6811853  2.6811853  2.7255499  2.7255499  3.30042261 3.30042261
 3.36795309 3.36795309 4.79981922 9.3852178 ]
   3 ( 0.000  0.500  0.500)   [0.03287438 0.03287606 0.27425428 0.27425428] [0.67599947 0.67600017 1.13082869 1.13082869 1.37676991 1.37677362
 1.74204523 1.74204523 1.97207088 1.97207333 2.42355699 2.42355699
 2.5210182  2.52102045 2.58028062 2.58028062 3.27376929 3.27377093
 4.64295598 4.64295598 6.59404191 6.59556057]
   4 ( 0.500 -0.000 -0.000)   [-0.07525641  0.009809    0.40447475  0.40447475] [0.81701656 0.81701656 0.82800112 1.14934277 1.32924357 1.50391783
 1.50391783 1.78950796 1.78950796 2.14724327 2.23124633 2.596366
 2.6811853  2.6811853  2.7255499  2.7255499  3.30042261 3.30042261
 3.36795309 3.36795309 4.79981922 9.3852178 ]
   5 ( 0.500  0.000  0.500)   [0.03287438 0.03287606 0.27425428 0.27425428] [0.67599947 0.67600017 1.13082869 1.13082869 1.37676991 1.37677362
 1.74204523 1.74204523 1.97207088 1.97207333 2.42355699 2.42355699
 2.5210182  2.52102045 2.58028062 2.58028062 3.27376929 3.27377093
 4.64295598 4.64295598 6.59404191 6.59556057]
   6 ( 0.500  0.500  0.000)   [0.03287438 0.03287606 0.27425428 0.27425428] [0.67599947 0.67600017 1.13082869 1.13082869 1.37676991 1.37677362
 1.74204523 1.74204523 1.97207088 1.97207333 2.42355699 2.42355699
 2.5210182  2.52102045 2.58028062 2.58028062 3.27376929 3.27377093
 4.64295598 4.64295598 6.59404191 6.59556057]
   7 ( 0.500  0.500  0.500)   [-0.07525641  0.009809    0.40447475  0.40447475] [0.81701656 0.81701656 0.82800112 1.14934277 1.32924357 1.50391783
 1.50391783 1.78950796 1.78950796 2.14724327 2.23124633 2.596366
 2.6811853  2.6811853  2.7255499  2.7255499  3.30042261 3.30042261
 3.36795309 3.36795309 4.79981922 9.3852178 ]
nelec by numeric integration = 8.000000000000131
    CPU time for vxc      1.57 sec, wall time      0.25 sec
    CPU time for vj and vk      1.45 sec, wall time      0.20 sec
Ewald components = 8.67997097708575e-26, -47.3756282134421, 34.5884981493536
E1 = (4.062999336127299+3.8377928795101974e-17j)  Ecoul = 1.069849871265736  Exc = -3.5968935157321766
cycle= 4 E= -11.2511743724276  delta_E= -2.09e-08  |g|= 9.7e-05  |ddm|= 0.0545
    CPU time for cycle= 4      3.04 sec, wall time      0.45 sec
HOMO = 0.509323616883  LUMO = 0.676000696363
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.28777008  0.50932362  0.50932362  0.50932362] [0.71166257 0.71166257 0.71166257 0.99010207 1.49383679 1.49383679
 1.76085014 1.76085014 1.76085014 1.78595488 2.27664355 2.27664355
 2.27664355 3.17335952 3.17335952 3.17335952 3.26399546 3.26399546
 4.31733412 4.31733412 4.31733412 4.86197276]
   1 ( 0.000  0.000  0.500)   [-0.07525405  0.00981082  0.40447769  0.40447769] [0.81701903 0.81701903 0.8280035  1.14934626 1.32924528 1.50392003
 1.50392003 1.78950956 1.78950956 2.1472451  2.23124723 2.59636782
 2.68118854 2.68118854 2.72555163 2.72555163 3.30042372 3.30042372
 3.36795519 3.36795519 4.7998208  9.38522556]
   2 (-0.000  0.500  0.000)   [-0.07525405  0.00981082  0.40447769  0.40447769] [0.81701903 0.81701903 0.8280035  1.14934626 1.32924528 1.50392003
 1.50392003 1.78950956 1.78950956 2.1472451  2.23124723 2.59636782
 2.68118854 2.68118854 2.72555163 2.72555163 3.30042372 3.30042372
 3.36795519 3.36795519 4.7998208  9.38522556]
   3 ( 0.000  0.500  0.500)   [0.03287656 0.0328785  0.27425687 0.27425687] [0.6760007  0.67600124 1.13083248 1.13083248 1.37676918 1.37677982
 1.74204694 1.74204694 1.97207186 1.9720756  2.4235594  2.4235594
 2.52101809 2.52102079 2.58028277 2.58028277 3.27376965 3.27377514
 4.64295753 4.64295753 6.59405552 6.59555573]
   4 ( 0.500 -0.000 -0.000)   [-0.07525405  0.00981082  0.40447769  0.40447769] [0.81701903 0.81701903 0.8280035  1.14934626 1.32924528 1.50392003
 1.50392003 1.78950956 1.78950956 2.1472451  2.23124723 2.59636782
 2.68118854 2.68118854 2.72555163 2.72555163 3.30042372 3.30042372
 3.36795519 3.36795519 4.7998208  9.38522556]
   5 ( 0.500  0.000  0.500)   [0.03287656 0.0328785  0.27425687 0.27425687] [0.6760007  0.67600124 1.13083248 1.13083248 1.37676918 1.37677982
 1.74204694 1.74204694 1.97207186 1.9720756  2.4235594  2.4235594
 2.52101809 2.52102079 2.58028277 2.58028277 3.27376965 3.27377514
 4.64295753 4.64295753 6.59405552 6.59555573]
   6 ( 0.500  0.500  0.000)   [0.03287656 0.0328785  0.27425687 0.27425687] [0.6760007  0.67600124 1.13083248 1.13083248 1.37676918 1.37677982
 1.74204694 1.74204694 1.97207186 1.9720756  2.4235594  2.4235594
 2.52101809 2.52102079 2.58028277 2.58028277 3.27376965 3.27377514
 4.64295753 4.64295754 6.59405552 6.59555573]
   7 ( 0.500  0.500  0.500)   [-0.07525405  0.00981082  0.40447769  0.40447769] [0.81701903 0.81701903 0.8280035  1.14934626 1.32924528 1.50392003
 1.50392003 1.78950956 1.78950956 2.1472451  2.23124723 2.59636782
 2.68118854 2.68118854 2.72555163 2.72555163 3.30042372 3.30042372
 3.36795519 3.36795519 4.7998208  9.38522556]
nelec by numeric integration = 8.000000000000131
    CPU time for vxc      1.64 sec, wall time      0.25 sec
    CPU time for vj and vk      1.46 sec, wall time      0.20 sec
Ewald components = 8.67997097708575e-26, -47.3756282134421, 34.5884981493536
E1 = (4.0630022099738+3.839096447807104e-17j)  Ecoul = 1.0698452666556053  Exc = -3.5968917843560075
Extra cycle  E= -11.2511743718151  delta_E= 6.13e-10  |g|= 0.000171  |ddm|= 0.00223
    CPU time for scf_cycle     20.37 sec, wall time      3.16 sec
    CPU time for SCF     20.39 sec, wall time      3.17 sec
converged SCF energy = -11.2511743718151

******** <class 'pyscf.pbc.mp.kmp2.KMP2'> ********
nkpts = 8
nocc = 4
nmo = 26
with_df_ints = True
max_memory 64000 MB (current use 0 MB)


******** <class 'pyscf.pbc.df.df.GDF'> ********
mesh = [7, 7, 7] (343 PWs)
auxbasis = None
eta = 0.2
exp_to_discard = None
_cderi_to_save = /Users/ethanvo/projects/interpolation/01_get_bands/tmp/tmpzfuu0qxn
len(kpts) = 8
    kpts = [[ 0.          0.          0.        ]
 [ 0.46609268  0.46609268 -0.46609268]
 [ 0.46609268 -0.46609268  0.46609268]
 [ 0.93218535  0.          0.        ]
 [-0.46609268  0.46609268  0.46609268]
 [ 0.          0.93218535  0.        ]
 [ 0.          0.          0.93218535]
 [ 0.46609268  0.46609268  0.46609268]]
Even tempered Gaussians are generated as DF auxbasis for  C
  ETB auxbasis for C  [[0, [9.579456, 1]], [0, [4.789728, 1]], [0, [2.394864, 1]], [0, [1.197432, 1]], [0, [0.598716, 1]], [0, [0.299358, 1]], [1, [8.727455361661383, 1]], [1, [4.363727680830691, 1]], [1, [2.1818638404153456, 1]], [1, [1.0909319202076728, 1]], [1, [0.5454659601038364, 1]], [1, [0.2727329800519182, 1]], [2, [7.951232, 1]], [2, [3.975616, 1]], [2, [1.987808, 1]], [2, [0.993904, 1]], [2, [0.496952, 1]], [2, [0.248476, 1]], [3, [2.1026146480075707, 1]], [3, [1.0513073240037853, 1]], [3, [0.5256536620018927, 1]], [4, [1.112026, 1]]]
num shells = 44, num cGTOs = 168
Drop 0 primitive fitting functions
make aux basis, num shells = 44, num cGTOs = 168
auxcell.rcut 12.846608924246357
make compensating basis, num shells = 10, num cGTOs = 50
chgcell.rcut 11.482117703874595
    CPU time for 3c2e    869.56 sec, wall time    102.45 sec
Num uniq kpts 14
uniq_kpts [[ 0.          0.          0.        ]
 [-0.46609268 -0.46609268  0.46609268]
 [-0.46609268  0.46609268 -0.46609268]
 [ 0.          0.93218535 -0.93218535]
 [-0.93218535  0.          0.        ]
 [ 0.46609268 -0.46609268 -0.46609268]
 [ 0.93218535  0.         -0.93218535]
 [ 0.93218535 -0.93218535  0.        ]
 [ 1.39827803 -0.46609268 -0.46609268]
 [ 0.         -0.93218535  0.        ]
 [ 0.46609268 -1.39827803  0.46609268]
 [ 0.          0.         -0.93218535]
 [ 0.46609268  0.46609268 -1.39827803]
 [-0.46609268 -0.46609268 -0.46609268]]
max_memory 64000 (MB)  blocksize 7339449
Cholesky decomposition for j2c at kpt 0
Symmetry pattern (k - [0. 0. 0.])*a= 2n pi
    make_kpt for uniq_kptji_ids [0]
kpt = [0. 0. 0.]
adapted_ji_idx = [ 0  2  5  9 14 20 27 35]
memory = 0
int3c2e [1/1], AO [0:10], ncol = 351
Symmetry pattern (k + [0. 0. 0.])*a= 2n pi
    make_kpt for [0]
Cholesky decomposition for j2c at kpt 1
Symmetry pattern (k - [-0.46609268 -0.46609268  0.46609268])*a= 2n pi
    make_kpt for uniq_kptji_ids [1]
kpt = [-0.46609268 -0.46609268  0.46609268]
adapted_ji_idx = [ 1  8 19 34]
memory = 0
int3c2e [1/1], AO [0:10], ncol = 676
Symmetry pattern (k + [-0.46609268 -0.46609268  0.46609268])*a= 2n pi
    make_kpt for [1]
Cholesky decomposition for j2c at kpt 2
Symmetry pattern (k - [-0.46609268  0.46609268 -0.46609268])*a= 2n pi
    make_kpt for uniq_kptji_ids [2]
kpt = [-0.46609268  0.46609268 -0.46609268]
adapted_ji_idx = [ 3  7 25 33]
memory = 0
int3c2e [1/1], AO [0:10], ncol = 676
Symmetry pattern (k + [-0.46609268  0.46609268 -0.46609268])*a= 2n pi
    make_kpt for [2]
Cholesky decomposition for j2c at kpt 3
Symmetry pattern (k - [ 0.          0.93218535 -0.93218535])*a= 2n pi
    make_kpt for uniq_kptji_ids [3 4]
kpt = [ 0.          0.93218535 -0.93218535]
adapted_ji_idx = [ 4 26]
memory = 0
int3c2e [1/1], AO [0:10], ncol = 676
kpt = [-0.93218535  0.          0.        ]
adapted_ji_idx = [ 6 32]
memory = 0
int3c2e [1/1], AO [0:10], ncol = 676
Symmetry pattern (k + [ 0.          0.93218535 -0.93218535])*a= 2n pi
    make_kpt for [3 4]
Cholesky decomposition for j2c at kpt 5
Symmetry pattern (k - [ 0.46609268 -0.46609268 -0.46609268])*a= 2n pi
    make_kpt for uniq_kptji_ids [5]
kpt = [ 0.46609268 -0.46609268 -0.46609268]
adapted_ji_idx = [10 16 23 31]
memory = 0
int3c2e [1/1], AO [0:10], ncol = 676
Symmetry pattern (k + [ 0.46609268 -0.46609268 -0.46609268])*a= 2n pi
    make_kpt for [5]
Cholesky decomposition for j2c at kpt 6
Symmetry pattern (k - [ 0.93218535  0.         -0.93218535])*a= 2n pi
    make_kpt for uniq_kptji_ids [6 9]
kpt = [ 0.93218535  0.         -0.93218535]
adapted_ji_idx = [11 24]
memory = 0
int3c2e [1/1], AO [0:10], ncol = 676
kpt = [ 0.         -0.93218535  0.        ]
adapted_ji_idx = [15 30]
memory = 0
int3c2e [1/1], AO [0:10], ncol = 676
Symmetry pattern (k + [ 0.93218535  0.         -0.93218535])*a= 2n pi
    make_kpt for [6 9]
Cholesky decomposition for j2c at kpt 7
Symmetry pattern (k - [ 0.93218535 -0.93218535  0.        ])*a= 2n pi
    make_kpt for uniq_kptji_ids [ 7 11]
kpt = [ 0.93218535 -0.93218535  0.        ]
adapted_ji_idx = [12 18]
memory = 0
int3c2e [1/1], AO [0:10], ncol = 676
kpt = [ 0.          0.         -0.93218535]
adapted_ji_idx = [21 29]
memory = 0
int3c2e [1/1], AO [0:10], ncol = 676
Symmetry pattern (k + [ 0.93218535 -0.93218535  0.        ])*a= 2n pi
    make_kpt for [ 7 11]
Cholesky decomposition for j2c at kpt 8
Symmetry pattern (k - [ 1.39827803 -0.46609268 -0.46609268])*a= 2n pi
    make_kpt for uniq_kptji_ids [ 8 10 12 13]
kpt = [ 1.39827803 -0.46609268 -0.46609268]
adapted_ji_idx = [13]
memory = 0
int3c2e [1/1], AO [0:10], ncol = 676
kpt = [ 0.46609268 -1.39827803  0.46609268]
adapted_ji_idx = [17]
memory = 0
int3c2e [1/1], AO [0:10], ncol = 676
kpt = [ 0.46609268  0.46609268 -1.39827803]
adapted_ji_idx = [22]
memory = 0
int3c2e [1/1], AO [0:10], ncol = 676
kpt = [-0.46609268 -0.46609268 -0.46609268]
adapted_ji_idx = [28]
memory = 0
int3c2e [1/1], AO [0:10], ncol = 676
Symmetry pattern (k + [ 1.39827803 -0.46609268 -0.46609268])*a= 2n pi
    make_kpt for [ 8 10 12 13]
    CPU time for j3c    933.39 sec, wall time    110.75 sec
    CPU time for transforming DF-MP2 integrals      0.17 sec, wall time      0.09 sec
    CPU time for KMP2    934.04 sec, wall time    111.12 sec
KMP2 energy = -0.392903889706422
