#INFO: **** input file is /burg/ccce/users/eav2136/projects/interpolation/01_get_bands/lif_df_dft_mp2.py ****
#!/usr/bin/env python
import numpy as np
from pyscf.pbc import gto, dft
from pyscf.pbc.tools import pyscf_ase, lattice, get_coulG
from pyscf.gto.basis import parse_nwchem
from pyscf import lib
from pyscf.pbc.lib.kpts_helper import get_kconserv, loop_kkk
from pyscf.pbc.df import df
from pyscf.ao2mo import _ao2mo
import h5py
import sys
from fileutils import load, dump

##############################
# Create a "Cell"
##############################

cell = gto.Cell()
# Candidate formula of solid: c, si, sic, bn, bp, aln, alp, mgo, mgs, lih, lif, licl
formula = "lif"
ase_atom = lattice.get_ase_atom(formula)
cell.atom = pyscf_ase.ase_atoms_to_pyscf(ase_atom)
cell.a = ase_atom.cell[:]
cell.unit = 'B'
cell.basis = {'Li': parse_nwchem.load("/burg/berkelbach/users/eav2136/builds/ccgto/basis/gth-hf-rev/cc-pvdz-lc.dat", 'Li'),
              'F': parse_nwchem.load("/burg/berkelbach/users/eav2136/builds/ccgto/basis/gth-hf-rev/cc-pvdz-lc.dat", 'F')}
cell.pseudo = {'Li': "gth-hf-rev-q1",
               'F': "gth-hf-rev"}
cell.verbose = 7
cell.build()

##############################
#  K-point SCF 
##############################
scf_mesh = int(sys.argv[1])
kmesh = [scf_mesh, scf_mesh, scf_mesh]
scaled_center=[0.0, 0.0, 0.0]
kpts = cell.make_kpts(kmesh, scaled_center=scaled_center)
mymf = dft.KRKS(cell, kpts=kpts)
mymf.xc = 'pbe'
mydf = df.GDF(cell, kpts=kpts)
mymf.with_df = mydf
ekrhf = mymf.kernel()

mp2_mesh = int(sys.argv[2])
kmesh = [mp2_mesh, mp2_mesh, mp2_mesh]
kpts = cell.make_kpts(kmesh, scaled_center=scaled_center)
mo_energy, mo_coeff = mymf.get_bands(kpts)
mo_energy = np.asarray(mo_energy)
mo_coeff = np.asarray(mo_coeff)

mydf = df.GDF(cell, kpts=kpts)
mydf.build()
nao = cell.nao_nr()
nocc = cell.nelectron // 2
nmo = mo_energy.shape[1]
nvir = nmo - nocc
nkpts = len(kpts)
kconserv = get_kconserv(cell, kpts)
naux = mydf.get_naoaux()

mo_e_o = [mo_energy[k][:nocc] for k in range(nkpts)]
mo_e_v = [mo_energy[k][nocc:] for k in range(nkpts)]
emp2 = 0.0

feri = lib.H5TmpFile()
Lov = feri.create_dataset('Lov', (nkpts, nkpts, naux, nocc, nvir), np.complex128)
bra_start = 0
bra_end = nocc
ket_start = nmo + nocc
ket_end = ket_start + nvir
with h5py.File(mydf._cderi, 'r') as f:
    kptij_lst = f['j3c-kptij'][:]
    tao = []
    ao_loc = None
    for ki, kpti in enumerate(kpts):
        for kj, kptj in enumerate(kpts):
            kpti_kptj = np.array((kpti, kptj))
            Lpq = np.asarray(df._getitem(f, 'j3c', kpti_kptj, kptij_lst))
            mo = np.hstack((mo_coeff[ki], mo_coeff[kj]))
            mo = np.asarray(mo, dtype=np.complex128, order='F')
            if Lpq[0].size != nao**2:
                Lpq = lib.unpack_tril(Lpq).astype(np.complex128)
            out = _ao2mo.r_e2(Lpq, mo, (bra_start, bra_end, ket_start, ket_end), tao, ao_loc)
            Lov[ki, kj] = out.reshape(-1, nocc, nvir)

for ki, kj, ka in loop_kkk(nkpts):
    kb = kconserv[ki, ka, kj]
    eia = mo_e_o[ki][:, None] - mo_e_v[ka]
    ejb = mo_e_o[kj][:, None] - mo_e_v[kb]
    eiajb = lib.direct_sum('ia,jb->iajb', eia, ejb)
    iajb = lib.einsum('Lia,Ljb->iajb', Lov[ki, ka], Lov[kj, kb]) / nkpts
    t2 = np.conj(iajb / eiajb)
    ibja = lib.einsum('Lib,Lja->ibja', Lov[ki, kb], Lov[kj, ka]) / nkpts
    emp2 += 2*lib.einsum('iajb,iajb', t2, iajb).real
    emp2 -=   lib.einsum('iajb,ibja', t2, ibja).real

emp2 /= nkpts
print("MP2 Correlation Energy: ", emp2)
total_energy = ekrhf + emp2

datafile = sys.argv[3]
datadict = {}
datadict['ekrhf'] = ekrhf
datadict['ekmp2'] = emp2
datadict['total_energy'] = total_energy
dump(datadict, f'data/{datafile}')#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='g112', release='4.18.0-193.el8.x86_64', version='#1 SMP Fri Mar 27 14:35:58 UTC 2020', machine='x86_64')  Threads 32
Python 3.10.12 (main, Jul 29 2023, 11:27:27) [GCC 13.2.0]
numpy 1.25.1  scipy 1.10.1
Date: Fri Dec 15 06:20:59 2023
PySCF version 2.0.1
PySCF path  /burg/berkelbach/users/eav2136/builds/pyscf/projected-cvs/pyscf
GIT HEAD (branch projected-cvs) 0bfbc692adf3ea63b8a509210433219cd1c472a2

[ENV] PYSCF_TMPDIR /burg/ccce/users/eav2136/projects/interpolation/01_get_bands/tmp
[ENV] PYSCF_MAX_MEMORY 700000
[CONFIG] DEBUG = False
[CONFIG] MAX_MEMORY = 700000
[CONFIG] TMPDIR = /burg/ccce/users/eav2136/projects/interpolation/01_get_bands/tmp
[CONFIG] UNIT = angstrom
[CONFIG] VERBOSE = 3
[CONFIG] conf_file = None
[INPUT] verbose = 7
[INPUT] max_memory = 700000 
[INPUT] num. atoms = 2
[INPUT] num. electrons = 8
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry False subgroup None
[INPUT] Mole.unit = B
[INPUT]  1 Li     0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr
[INPUT]  2 F      2.017549855265   0.000000000000   0.000000000000 AA    3.812616669107   0.000000000000   0.000000000000 Bohr
[INPUT] ---------------- BASIS SET ---------------- 
[INPUT] l, kappa, [nprim/nctr], expnt,             c_1 c_2 ...
[INPUT] Li
[INPUT] 0    0    [1    /1   ]  0.824233             1
[INPUT] 0    0    [1    /1   ]  0.047102             1
[INPUT] 1    0    [1    /1   ]  0.41144              1
[INPUT] 1    0    [1    /1   ]  0.08307              1
[INPUT] 2    0    [1    /1   ]  0.1                  1
[INPUT] F
[INPUT] 0    0    [5    /1   ]  19.343755         -0.03328997
                                8.171844          -0.1351323
                                1.512425          0.381406
                                0.605694          0.5424488
                                0.236889          0.2066114
[INPUT] 0    0    [1    /1   ]  0.29368              1
[INPUT] 1    0    [5    /1   ]  13.593218         0.06032943
                                4.780664          0.1889363
                                1.707567          0.3707187
                                0.602699          0.4233239
                                0.200679          0.2156237
[INPUT] 1    0    [1    /1   ]  0.357926             1
[INPUT] 2    0    [1    /1   ]  1.660824             1

Ewald components = 4.62253161018766e-90, -105.966782880783, 89.9345283064059
nuclear repulsion = -16.0322545743775
number of shells = 10
number of NR pGTOs = 42
number of NR cGTOs = 26
basis = {'Li': [[0, [0.824233, 1.0]], [0, [0.047102, 1.0]], [1, [0.41144, 1.0]], [1, [0.08307, 1.0]], [2, [0.1, 1.0]]], 'F': [[0, [19.343755, -0.03328997], [8.171844, -0.1351323], [1.512425, 0.381406], [0.605694, 0.5424488], [0.236889, 0.2066114]], [0, [0.29368, 1.0]], [1, [13.593218, 0.06032943], [4.780664, 0.1889363], [1.707567, 0.3707187], [0.602699, 0.4233239], [0.200679, 0.2156237]], [1, [0.357926, 1.0]], [2, [1.660824, 1.0]]]}
ecp = {}
bas 0, expnt(s) = [0.824233]
bas 1, expnt(s) = [0.047102]
bas 2, expnt(s) = [0.41144]
bas 3, expnt(s) = [0.08307]
bas 4, expnt(s) = [0.1]
bas 5, expnt(s) = [19.343755  8.171844  1.512425  0.605694  0.236889]
bas 6, expnt(s) = [0.29368]
bas 7, expnt(s) = [13.593218  4.780664  1.707567  0.602699  0.200679]
bas 8, expnt(s) = [0.357926]
bas 9, expnt(s) = [1.660824]
CPU time:         1.09
lattice vectors  a1 [0.000000000, 3.812616669, 3.812616669]
                 a2 [3.812616669, 0.000000000, 3.812616669]
                 a3 [3.812616669, 3.812616669, 0.000000000]
dimension = 3
low_dim_ft_type = None
Cell volume = 110.841
rcut = 32.30633967981401 (nimgs = [8 8 8])
lattice sum = 2618 cells
precision = 1e-08
pseudo = {'Li': 'gth-hf-rev-q1', 'F': 'gth-hf-rev'}
ke_cutoff = 817.8924637485218
    = [57 57 57] mesh (185193 PWs)


******** <class 'pyscf.pbc.dft.krks.KRKS'> ********
method = KRKS-KohnShamDFT
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-07
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /burg/ccce/users/eav2136/projects/interpolation/01_get_bands/tmp/tmpzafh1z5v
max_memory 700000 MB (current use 82 MB)


******** PBC SCF flags ********
N kpts = 8
kpts = [[ 0.00000000e+00  0.00000000e+00  0.00000000e+00]
 [ 4.11999543e-01  4.11999543e-01 -4.11999543e-01]
 [ 4.11999543e-01 -4.11999543e-01  4.11999543e-01]
 [ 8.23999087e-01  0.00000000e+00  0.00000000e+00]
 [-4.11999543e-01  4.11999543e-01  4.11999543e-01]
 [ 0.00000000e+00  8.23999087e-01  0.00000000e+00]
 [-1.11022302e-16  0.00000000e+00  8.23999087e-01]
 [ 4.11999543e-01  4.11999543e-01  4.11999543e-01]]
Exchange divergence treatment (exxdiv) = ewald
Monkhorst pack size [2 2 2] ew_eta 2.713960907918145 ew_cut 2.593623641976006
Ewald components = 0, -1.5314289789504, 1.38111023211859
    madelung (= occupied orbital energy shift) = 0.3006374936636229
    Total energy shift due to Ewald probe charge = -1/2 * Nelec*madelung = -1.20254997465
DF object = <pyscf.pbc.df.df.GDF object at 0x155535e80fa0>
XC functionals = pbe
small_rho_cutoff = 1e-07
Uniform grid, mesh = [57 57 57]
Set gradient conv threshold to 0.000316228
Density of valence part of ANO basis will be used as initial guess for Li
Big error detected in the electron number of initial guess density matrix (Ne/cell = 8.85492)!
  This can cause huge error in Fock matrix and lead to instability in SCF for low-dimensional systems.
  DM is normalized wrt the number of electrons 8.0
    CPU time for vnuc pass1: analytic int    218.21 sec, wall time      9.11 sec
    CPU time for contracting Vnuc [0:343]     10.38 sec, wall time      0.41 sec
    CPU time for contracting Vnuc     10.39 sec, wall time      0.41 sec
    CPU time for get_pp_loc_part1    228.64 sec, wall time      9.52 sec
    CPU time for get_pp_loc_part2    353.04 sec, wall time     14.08 sec
    CPU time for get_pp_nl      1.10 sec, wall time      0.04 sec
    CPU time for get_pp    582.78 sec, wall time     23.64 sec
    CPU time for setting up grids     14.10 sec, wall time      1.97 sec
nelec by numeric integration = 7.99999999999823
    CPU time for vxc     51.51 sec, wall time      1.86 sec


******** <class 'pyscf.pbc.df.df.GDF'> ********
mesh = [7, 7, 7] (343 PWs)
auxbasis = None
eta = 0.2
exp_to_discard = None
_cderi_to_save = /burg/ccce/users/eav2136/projects/interpolation/01_get_bands/tmp/tmpes5_761z
len(kpts) = 8
    kpts = [[ 0.00000000e+00  0.00000000e+00  0.00000000e+00]
 [ 4.11999543e-01  4.11999543e-01 -4.11999543e-01]
 [ 4.11999543e-01 -4.11999543e-01  4.11999543e-01]
 [ 8.23999087e-01  0.00000000e+00  0.00000000e+00]
 [-4.11999543e-01  4.11999543e-01  4.11999543e-01]
 [ 0.00000000e+00  8.23999087e-01  0.00000000e+00]
 [-1.11022302e-16  0.00000000e+00  8.23999087e-01]
 [ 4.11999543e-01  4.11999543e-01  4.11999543e-01]]
Even tempered Gaussians are generated as DF auxbasis for  F Li
  ETB auxbasis for F  [[0, [30.321792, 1]], [0, [15.160896, 1]], [0, [7.580448, 1]], [0, [3.790224, 1]], [0, [1.895112, 1]], [0, [0.947556, 1]], [0, [0.473778, 1]], [1, [27.9082998906473, 1]], [1, [13.95414994532365, 1]], [1, [6.977074972661825, 1]], [1, [3.4885374863309124, 1]], [1, [1.7442687431654562, 1]], [1, [0.8721343715827281, 1]], [1, [0.43606718579136405, 1]], [2, [25.686912, 1]], [2, [12.843456, 1]], [2, [6.421728, 1]], [2, [3.210864, 1]], [2, [1.605432, 1]], [2, [0.802716, 1]], [2, [0.401358, 1]], [3, [9.237038479457363, 1]], [3, [4.618519239728681, 1]], [3, [2.3092596198643407, 1]], [3, [1.1546298099321703, 1]], [4, [3.321648, 1]]]
  ETB auxbasis for Li  [[0, [1.507264, 1]], [0, [0.753632, 1]], [0, [0.376816, 1]], [0, [0.188408, 1]], [0, [0.094204, 1]], [1, [1.0008333346966416, 1]], [1, [0.5004166673483208, 1]], [1, [0.2502083336741604, 1]], [1, [0.1251041668370802, 1]], [2, [0.66456, 1]], [2, [0.33228, 1]], [2, [0.16614, 1]]]
num shells = 38, num cGTOs = 132
Drop 0 primitive fitting functions
make aux basis, num shells = 38, num cGTOs = 132
auxcell.rcut 18.557689188298266
make compensating basis, num shells = 8, num cGTOs = 34
chgcell.rcut 11.482117703874595
    CPU time for 3c2e   4233.92 sec, wall time    234.83 sec
Num uniq kpts 14
uniq_kpts [[ 0.00000000e+00  0.00000000e+00  0.00000000e+00]
 [-4.11999543e-01 -4.11999543e-01  4.11999543e-01]
 [-4.11999543e-01  4.11999543e-01 -4.11999543e-01]
 [ 1.11022302e-16  8.23999087e-01 -8.23999087e-01]
 [-8.23999087e-01  0.00000000e+00  0.00000000e+00]
 [ 4.11999543e-01 -4.11999543e-01 -4.11999543e-01]
 [ 8.23999087e-01  0.00000000e+00 -8.23999087e-01]
 [ 8.23999087e-01 -8.23999087e-01  0.00000000e+00]
 [ 1.23599863e+00 -4.11999543e-01 -4.11999543e-01]
 [ 0.00000000e+00 -8.23999087e-01  0.00000000e+00]
 [ 4.11999543e-01 -1.23599863e+00  4.11999543e-01]
 [ 1.11022302e-16  0.00000000e+00 -8.23999087e-01]
 [ 4.11999543e-01  4.11999543e-01 -1.23599863e+00]
 [-4.11999543e-01 -4.11999543e-01 -4.11999543e-01]]
max_memory 699378.010112 (MB)  blocksize 105328013
Cholesky decomposition for j2c at kpt 0
Symmetry pattern (k - [0. 0. 0.])*a= 2n pi
    make_kpt for uniq_kptji_ids [0]
kpt = [0. 0. 0.]
adapted_ji_idx = [ 0  2  5  9 14 20 27 35]
memory = 623.63648
int3c2e [1/1], AO [0:10], ncol = 351
Symmetry pattern (k + [0. 0. 0.])*a= 2n pi
    make_kpt for [0]
Cholesky decomposition for j2c at kpt 1
Symmetry pattern (k - [-0.41199954 -0.41199954  0.41199954])*a= 2n pi
    make_kpt for uniq_kptji_ids [1]
kpt = [-0.41199954 -0.41199954  0.41199954]
adapted_ji_idx = [ 1  8 19 34]
memory = 673.415168
int3c2e [1/1], AO [0:10], ncol = 676
Symmetry pattern (k + [-0.41199954 -0.41199954  0.41199954])*a= 2n pi
    make_kpt for [1]
Cholesky decomposition for j2c at kpt 2
Symmetry pattern (k - [-0.41199954  0.41199954 -0.41199954])*a= 2n pi
    make_kpt for uniq_kptji_ids [2]
kpt = [-0.41199954  0.41199954 -0.41199954]
adapted_ji_idx = [ 3  7 25 33]
memory = 745.209856
int3c2e [1/1], AO [0:10], ncol = 676
Symmetry pattern (k + [-0.41199954  0.41199954 -0.41199954])*a= 2n pi
    make_kpt for [2]
Cholesky decomposition for j2c at kpt 3
Symmetry pattern (k - [ 1.11022302e-16  8.23999087e-01 -8.23999087e-01])*a= 2n pi
    make_kpt for uniq_kptji_ids [3 4]
kpt = [ 1.11022302e-16  8.23999087e-01 -8.23999087e-01]
adapted_ji_idx = [ 4 26]
memory = 764.27264
int3c2e [1/1], AO [0:10], ncol = 676
kpt = [-0.82399909  0.          0.        ]
adapted_ji_idx = [ 6 32]
memory = 789.970944
int3c2e [1/1], AO [0:10], ncol = 676
Symmetry pattern (k + [ 1.11022302e-16  8.23999087e-01 -8.23999087e-01])*a= 2n pi
    make_kpt for [3 4]
Cholesky decomposition for j2c at kpt 5
Symmetry pattern (k - [ 0.41199954 -0.41199954 -0.41199954])*a= 2n pi
    make_kpt for uniq_kptji_ids [5]
kpt = [ 0.41199954 -0.41199954 -0.41199954]
adapted_ji_idx = [10 16 23 31]
memory = 802.95936
int3c2e [1/1], AO [0:10], ncol = 676
Symmetry pattern (k + [ 0.41199954 -0.41199954 -0.41199954])*a= 2n pi
    make_kpt for [5]
Cholesky decomposition for j2c at kpt 6
Symmetry pattern (k - [ 0.82399909  0.         -0.82399909])*a= 2n pi
    make_kpt for uniq_kptji_ids [6 9]
kpt = [ 0.82399909  0.         -0.82399909]
adapted_ji_idx = [11 24]
memory = 819.970048
int3c2e [1/1], AO [0:10], ncol = 676
kpt = [ 0.         -0.82399909  0.        ]
adapted_ji_idx = [15 30]
memory = 835.014656
int3c2e [1/1], AO [0:10], ncol = 676
Symmetry pattern (k + [ 0.82399909  0.         -0.82399909])*a= 2n pi
    make_kpt for [6 9]
Cholesky decomposition for j2c at kpt 7
Symmetry pattern (k - [ 0.82399909 -0.82399909  0.        ])*a= 2n pi
    make_kpt for uniq_kptji_ids [ 7 11]
kpt = [ 0.82399909 -0.82399909  0.        ]
adapted_ji_idx = [12 18]
memory = 846.299136
int3c2e [1/1], AO [0:10], ncol = 676
kpt = [ 1.11022302e-16  0.00000000e+00 -8.23999087e-01]
adapted_ji_idx = [21 29]
memory = 850.464768
int3c2e [1/1], AO [0:10], ncol = 676
Symmetry pattern (k + [ 0.82399909 -0.82399909  0.        ])*a= 2n pi
    make_kpt for [ 7 11]
Cholesky decomposition for j2c at kpt 8
Symmetry pattern (k - [ 1.23599863 -0.41199954 -0.41199954])*a= 2n pi
    make_kpt for uniq_kptji_ids [ 8 10 12 13]
kpt = [ 1.23599863 -0.41199954 -0.41199954]
adapted_ji_idx = [13]
memory = 849.18272
int3c2e [1/1], AO [0:10], ncol = 676
kpt = [ 0.41199954 -1.23599863  0.41199954]
adapted_ji_idx = [17]
memory = 858.112
int3c2e [1/1], AO [0:10], ncol = 676
kpt = [ 0.41199954  0.41199954 -1.23599863]
adapted_ji_idx = [22]
memory = 860.209152
int3c2e [1/1], AO [0:10], ncol = 676
kpt = [-0.41199954 -0.41199954 -0.41199954]
adapted_ji_idx = [28]
memory = 862.445568
int3c2e [1/1], AO [0:10], ncol = 676
Symmetry pattern (k + [ 1.23599863 -0.41199954 -0.41199954])*a= 2n pi
    make_kpt for [ 8 10 12 13]
    CPU time for j3c   4440.59 sec, wall time    241.85 sec
    CPU time for Init get_j_kpts   4441.05 sec, wall time    241.87 sec
    CPU time for get_j pass 1      2.89 sec, wall time      0.09 sec
    CPU time for get_j pass 2      0.38 sec, wall time      0.02 sec
    CPU time for vj and vk   4444.59 sec, wall time    241.99 sec
Ewald components = 4.62253161018766e-90, -105.966782880783, 89.9345283064059
E1 = (-10.33443814188018+7.564847856621574e-30j)  Ecoul = 6.5121468576923  Exc = -4.530181307800591
init E= -24.384727166366
cond(S) = [587455.87048076  95377.00013026  95377.00012934  79796.10117574
  95377.00012966  79796.10116738  79796.10116685  95377.00013006]
    CPU time for initialize scf   5105.31 sec, wall time    270.09 sec
HOMO = -0.266635978622  LUMO = 0.292541368514
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.973031   -0.26670746 -0.26670746 -0.26663598] [0.29254137 0.88656543 0.88657604 0.88657604 0.90138845 0.90138845
 0.9014138  1.14809849 1.14811067 1.71242269 1.71242269 1.71245482
 2.11678354 2.9111284  2.91112841 2.91116239 3.81229585 3.81235481
 3.81235481 3.9518755  3.95194841 4.0387381 ]
   1 (-0.000  0.000  0.500)   [-0.96206378 -0.31322934 -0.27214775 -0.27210106] [0.37982887 0.51801237 0.71226343 0.71227391 1.09113806 1.09114198
 1.12340978 1.52503016 1.5944964  1.59450853 1.63300319 1.63301433
 2.24980522 2.57416485 2.88641191 2.95949738 2.95952026 3.60934838
 3.60938655 3.7599619  3.91535342 3.91535513]
   2 ( 0.000  0.500  0.000)   [-0.96206378 -0.31322934 -0.27214775 -0.27210106] [0.37982887 0.51801237 0.71226343 0.71227391 1.09113806 1.09114198
 1.12340978 1.52503016 1.5944964  1.59450853 1.63300318 1.63301432
 2.24980522 2.57416485 2.88641191 2.95949736 2.95952024 3.60934838
 3.60938655 3.7599619  3.91535342 3.91535513]
   3 ( 0.000  0.500  0.500)   [-0.95676821 -0.31971175 -0.28474879 -0.28474879] [0.44787433 0.60114127 0.63309907 0.70662375 0.70662375 1.20124584
 1.37805776 1.55012674 1.57652328 1.57652328 1.6886118  1.6886118
 2.37465033 2.37465033 2.38081431 2.46343122 3.70729008 3.70729008
 3.72473066 3.83560182 4.17416758 5.35353334]
   4 ( 0.500 -0.000 -0.000)   [-0.96206378 -0.31322934 -0.27214775 -0.27210106] [0.37982887 0.51801237 0.71226343 0.71227391 1.09113806 1.09114198
 1.12340978 1.52503016 1.5944964  1.59450853 1.63300318 1.63301432
 2.24980522 2.57416485 2.88641191 2.95949736 2.95952024 3.60934838
 3.60938655 3.7599619  3.91535342 3.91535513]
   5 ( 0.500  0.000  0.500)   [-0.95676782 -0.31977533 -0.28474959 -0.28468009] [0.44785585 0.60114675 0.63309963 0.70662289 0.70664314 1.20123283
 1.37807651 1.55009392 1.5765141  1.57652023 1.68861136 1.68864374
 2.37466431 2.37469413 2.38081191 2.4633811  3.70723014 3.70729196
 3.72479194 3.83554853 4.17421818 5.35353512]
   6 ( 0.500  0.500 -0.000)   [-0.95676782 -0.31977533 -0.28474959 -0.28468009] [0.44785585 0.60114675 0.63309963 0.70662289 0.70664314 1.20123283
 1.37807651 1.55009392 1.5765141  1.57652023 1.68861136 1.68864374
 2.37466431 2.37469413 2.38081191 2.4633811  3.70723014 3.70729196
 3.72479194 3.83554853 4.17421818 5.35353512]
   7 ( 0.500  0.500  0.500)   [-0.96206378 -0.31322934 -0.27214775 -0.27210106] [0.37982887 0.51801237 0.71226343 0.71227391 1.09113806 1.09114198
 1.12340978 1.52503016 1.5944964  1.59450853 1.63300318 1.63301433
 2.24980522 2.57416485 2.88641191 2.95949737 2.95952025 3.60934838
 3.60938655 3.7599619  3.91535342 3.91535513]
nelec by numeric integration = 7.999999999998752
    CPU time for vxc     44.56 sec, wall time      1.42 sec
    CPU time for get_j pass 1      2.18 sec, wall time      0.07 sec
    CPU time for get_j pass 2      1.75 sec, wall time      0.06 sec
    CPU time for vj and vk      3.94 sec, wall time      0.12 sec
Ewald components = 4.62253161018766e-90, -105.966782880783, 89.9345283064059
E1 = (-14.142902575883044+1.5646741899021337e-29j)  Ecoul = 11.563645239451803  Exc = -5.627002982366143
cycle= 1 E= -24.2385148931749  delta_E= 0.146  |g|= 4.13  |ddm|= 21.5
    CPU time for cycle= 1     49.48 sec, wall time      1.77 sec
diis-norm(errvec)=6.47334
diis-c [-41.90413263+0.j   1.        +0.j]
HOMO = 0.349516188018  LUMO = 0.460709586751
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.39915944  0.34951195  0.34951619  0.34951619] [0.46070959 0.94000977 0.94000977 0.94001179 0.95887533 0.95887729
 0.95887729 1.21724063 1.21724139 2.1255932  2.14167896 2.14168179
 2.14168179 2.942979   2.94298013 2.94298014 4.41253132 4.41253132
 4.41253478 4.42376021 4.54226588 4.54227031]
   1 (-0.000  0.000  0.500)   [-0.35675496  0.13489527  0.3329896   0.33299213] [0.49016664 0.74291086 0.74291162 0.84940065 1.14585865 1.25157359
 1.25157397 1.54923895 1.64628515 1.64628522 1.77087461 1.77087612
 2.38775219 2.91518078 3.18962635 3.33746798 3.33746931 4.21735416
 4.21735632 4.35475829 4.50436661 4.50436673]
   2 ( 0.000  0.500  0.000)   [-0.35675496  0.13489527  0.3329896   0.33299213] [0.49016664 0.74291086 0.74291162 0.84940065 1.14585865 1.25157359
 1.25157397 1.54923895 1.64628515 1.64628522 1.77087461 1.7708761
 2.38775219 2.91518078 3.18962635 3.33746798 3.33746929 4.21735416
 4.21735632 4.35475829 4.50436661 4.50436673]
   3 ( 0.000  0.500  0.500)   [-0.33495602  0.09960505  0.25828549  0.25828549] [0.64457581 0.70304071 0.80117803 0.9024774  0.9024774  1.34485181
 1.47148616 1.56319566 1.62129056 1.62129056 1.77804857 1.77804857
 2.4087591  2.74277223 2.74277223 2.89781402 4.30565713 4.30565713
 4.33053855 4.41665932 4.74963028 5.74817461]
   4 ( 0.500 -0.000 -0.000)   [-0.35675496  0.13489527  0.3329896   0.33299213] [0.49016664 0.74291086 0.74291162 0.84940065 1.14585866 1.25157359
 1.25157397 1.54923895 1.64628515 1.64628522 1.7708746  1.7708761
 2.38775219 2.91518078 3.18962635 3.33746797 3.33746929 4.21735416
 4.21735632 4.35475829 4.50436661 4.50436673]
   5 ( 0.500  0.000  0.500)   [-0.33495615  0.0996076   0.25828206  0.25828585] [0.64457478 0.70304026 0.80118135 0.90247487 0.90247762 1.34485306
 1.47148441 1.56319715 1.62129169 1.62129189 1.77804736 1.77804923
 2.40875937 2.74276923 2.74277196 2.89781729 4.3056571  4.30566055
 4.3305351  4.41666297 4.74962694 5.74817383]
   6 ( 0.500  0.500 -0.000)   [-0.33495615  0.0996076   0.25828206  0.25828585] [0.64457478 0.70304026 0.80118135 0.90247487 0.90247762 1.34485306
 1.4714844  1.56319715 1.62129169 1.62129189 1.77804736 1.77804923
 2.40875937 2.74276923 2.74277196 2.89781729 4.3056571  4.30566055
 4.3305351  4.41666297 4.74962694 5.74817382]
   7 ( 0.500  0.500  0.500)   [-0.35675496  0.13489527  0.3329896   0.33299213] [0.49016664 0.74291086 0.74291162 0.84940065 1.14585866 1.25157359
 1.25157397 1.54923895 1.64628515 1.64628522 1.77087461 1.77087611
 2.38775219 2.91518078 3.18962635 3.33746798 3.3374693  4.21735416
 4.21735632 4.35475829 4.50436661 4.50436673]
nelec by numeric integration = 7.999999999999088
    CPU time for vxc     45.65 sec, wall time      1.44 sec
    CPU time for get_j pass 1      4.03 sec, wall time      0.13 sec
    CPU time for get_j pass 2      0.37 sec, wall time      0.02 sec
    CPU time for vj and vk      4.67 sec, wall time      0.16 sec
Ewald components = 4.62253161018766e-90, -105.966782880783, 89.9345283064059
E1 = (-8.144786485841118+1.5377068918812754e-28j)  Ecoul = 4.562058367450137  Exc = -4.0710450429950304
cycle= 2 E= -23.6860277357635  delta_E= 0.552  |g|= 6.54  |ddm|= 27.6
    CPU time for cycle= 2     52.34 sec, wall time      1.66 sec
diis-norm(errvec)=11.9969
diis-c [-0.51940169+8.75811540e-47j  0.65053321-1.51316221e-32j
  0.34946679+1.51316221e-32j]
HOMO = 0.0514697272769  LUMO = 0.369372641257
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.67712817  0.05146691  0.05146973  0.05146973] [0.36937264 0.92416167 0.92416167 0.92416293 0.93862299 0.93862431
 0.93862431 1.18920564 1.18920614 1.89615937 1.89616087 1.89616087
 2.16105542 2.94712876 2.94712949 2.9471295  4.10364059 4.10364059
 4.10364274 4.22386731 4.23776658 4.23776931]
   1 (-0.000  0.000  0.500)   [-0.65651849 -0.04999247  0.04210035  0.04210215] [0.43708164 0.6531077  0.73978618 0.73978663 1.14954746 1.173208
 1.17320821 1.55546249 1.63532839 1.6353284  1.69649921 1.69650001
 2.35242335 2.73396448 3.02644263 3.12916606 3.12916678 3.90470287
 3.90470425 4.04820121 4.20085756 4.2008576 ]
   2 ( 0.000  0.500  0.000)   [-0.65651849 -0.04999247  0.04210035  0.04210215] [0.43708164 0.6531077  0.73978618 0.73978663 1.14954746 1.173208
 1.17320821 1.55546249 1.63532838 1.6353284  1.6964992  1.6965
 2.35242335 2.73396448 3.02644263 3.12916604 3.12916675 3.90470287
 3.90470425 4.04820121 4.20085756 4.2008576 ]
   3 ( 0.000  0.500  0.500)   [-0.64647223 -0.06668208  0.01209946  0.01209946] [0.59000271 0.63751634 0.67556789 0.79187122 0.79187122 1.26875836
 1.42739096 1.57508147 1.61266756 1.61266756 1.74544128 1.74544128
 2.43618032 2.53571774 2.53571774 2.6600211  3.99752314 3.99752314
 4.01908824 4.11737196 4.45119027 5.54316917]
   4 ( 0.500 -0.000 -0.000)   [-0.65651849 -0.04999247  0.04210035  0.04210215] [0.43708164 0.6531077  0.73978618 0.73978663 1.14954746 1.17320799
 1.17320821 1.55546249 1.63532838 1.63532841 1.6964992  1.69649999
 2.35242335 2.73396448 3.02644263 3.12916605 3.12916674 3.90470287
 3.90470425 4.04820121 4.20085756 4.2008576 ]
   5 ( 0.500  0.000  0.500)   [-0.64647227 -0.0666799   0.01209687  0.01209956] [0.59000432 0.6375157  0.67556742 0.79186992 0.79187155 1.26875931
 1.42738987 1.5750824  1.61266826 1.6126684  1.74544049 1.74544155
 2.4361805  2.53571605 2.53571765 2.66002304 3.99752312 3.99752526
 4.01908609 4.11737419 4.45118821 5.54316868]
   6 ( 0.500  0.500 -0.000)   [-0.64647227 -0.0666799   0.01209687  0.01209956] [0.59000432 0.6375157  0.67556742 0.79186992 0.79187155 1.26875931
 1.42738986 1.5750824  1.61266826 1.6126684  1.74544049 1.74544155
 2.4361805  2.53571605 2.53571765 2.66002304 3.99752312 3.99752526
 4.01908609 4.11737419 4.45118821 5.54316868]
   7 ( 0.500  0.500  0.500)   [-0.65651849 -0.04999247  0.04210035  0.04210215] [0.43708164 0.6531077  0.73978618 0.73978663 1.14954746 1.173208
 1.17320821 1.55546249 1.63532839 1.6353284  1.69649921 1.6965
 2.35242335 2.73396448 3.02644263 3.12916605 3.12916676 3.90470287
 3.90470425 4.04820121 4.20085756 4.2008576 ]
nelec by numeric integration = 7.9999999999988525
    CPU time for vxc     44.74 sec, wall time      1.45 sec
    CPU time for get_j pass 1      2.58 sec, wall time      0.08 sec
    CPU time for get_j pass 2      1.63 sec, wall time      0.05 sec
    CPU time for vj and vk      4.31 sec, wall time      0.14 sec
Ewald components = 4.62253161018766e-90, -105.966782880783, 89.9345283064059
E1 = (-11.923161594280325+1.0523304161781585e-29j)  Ecoul = 8.308742554831147  Exc = -4.924762781964353
cycle= 3 E= -24.571436395791  delta_E= -0.885  |g|= 0.464  |ddm|= 22.2
    CPU time for cycle= 3     52.46 sec, wall time      1.85 sec
diis-norm(errvec)=0.725724
diis-c [-4.24418504e-04-2.24207754e-44j  9.45620495e-02+1.24967415e-30j
 -4.02444908e-03+7.90842063e-31j  9.09462400e-01-2.04051621e-30j]
HOMO = 0.0304501198921  LUMO = 0.361408001782
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.69494453  0.03044987  0.03045012  0.03045012] [0.361408   0.92088261 0.92088261 0.92088273 0.93433782 0.93433793
 0.93433793 1.1861449  1.18614493 1.87738944 1.87738958 1.87738958
 2.15924964 2.94623937 2.94623943 2.94623944 4.08946937 4.08946937
 4.08946956 4.20759063 4.22356289 4.22356312]
   1 (-0.000  0.000  0.500)   [-0.67513372 -0.0658969   0.02137058  0.02137074] [0.43102428 0.63891203 0.73667303 0.73667307 1.14568142 1.1649795
 1.16497952 1.55342083 1.63377111 1.63377112 1.6890589  1.68905897
 2.34413379 2.7211532  3.01143717 3.11323344 3.11323351 3.89066595
 3.89066607 4.03392136 4.18679229 4.18679229]
   2 ( 0.000  0.500  0.000)   [-0.67513372 -0.0658969   0.02137058  0.02137074] [0.43102428 0.63891203 0.73667303 0.73667307 1.14568142 1.1649795
 1.16497952 1.55342083 1.63377111 1.63377112 1.68905889 1.68905895
 2.34413379 2.7211532  3.01143717 3.11323343 3.11323349 3.89066595
 3.89066607 4.03392136 4.18679229 4.18679229]
   3 ( 0.000  0.500  0.500)   [-0.66548432 -0.08167095 -0.00682475 -0.00682475] [0.57528546 0.63334981 0.67086781 0.78279309 0.78279309 1.2625638
 1.42403804 1.57315647 1.60833819 1.60833819 1.74147541 1.74147541
 2.43318296 2.51929973 2.51929973 2.64018137 3.98344338 3.98344338
 4.00490185 4.10325361 4.43694446 5.52713166]
   4 ( 0.500 -0.000 -0.000)   [-0.67513372 -0.0658969   0.02137058  0.02137074] [0.43102428 0.63891203 0.73667303 0.73667307 1.14568142 1.1649795
 1.16497952 1.55342083 1.63377111 1.63377112 1.68905889 1.68905896
 2.34413379 2.7211532  3.01143717 3.11323342 3.1132335  3.89066595
 3.89066607 4.03392136 4.18679229 4.18679229]
   5 ( 0.500  0.000  0.500)   [-0.66548433 -0.08167076 -0.00682498 -0.00682474] [0.57528561 0.63334975 0.67086777 0.78279298 0.78279313 1.26256388
 1.42403796 1.57315654 1.60833825 1.60833826 1.74147534 1.74147543
 2.43318297 2.51929958 2.51929973 2.64018155 3.98344338 3.98344356
 4.00490166 4.1032538  4.43694429 5.52713161]
   6 ( 0.500  0.500 -0.000)   [-0.66548433 -0.08167076 -0.00682498 -0.00682474] [0.57528561 0.63334975 0.67086777 0.78279298 0.78279313 1.26256388
 1.42403796 1.57315654 1.60833825 1.60833826 1.74147534 1.74147543
 2.43318297 2.51929958 2.51929973 2.64018155 3.98344338 3.98344356
 4.00490166 4.1032538  4.43694429 5.52713161]
   7 ( 0.500  0.500  0.500)   [-0.67513372 -0.0658969   0.02137058  0.02137074] [0.43102428 0.63891203 0.73667303 0.73667307 1.14568142 1.1649795
 1.16497952 1.55342083 1.63377111 1.63377112 1.6890589  1.68905896
 2.34413379 2.7211532  3.01143717 3.11323344 3.1132335  3.89066595
 3.89066607 4.03392136 4.18679229 4.18679229]
nelec by numeric integration = 7.999999999998829
    CPU time for vxc     45.69 sec, wall time      1.47 sec
    CPU time for get_j pass 1      2.62 sec, wall time      0.08 sec
    CPU time for get_j pass 2      1.22 sec, wall time      0.04 sec
    CPU time for vj and vk      3.84 sec, wall time      0.12 sec
Ewald components = 4.62253161018766e-90, -105.966782880783, 89.9345283064059
E1 = (-12.142267207483634+3.614433057254955e-29j)  Ecoul = 8.5845181511381  Exc = -4.9852615292714635
cycle= 4 E= -24.5752651599945  delta_E= -0.00383  |g|= 0.023  |ddm|= 2.41
    CPU time for cycle= 4     50.82 sec, wall time      1.63 sec
diis-norm(errvec)=0.0373331
diis-c [-4.35343440e-07+3.36311631e-44j  9.66232661e-04-2.18055423e-30j
 -4.14423370e-04+1.17731269e-31j -3.79728281e-02-2.26357800e-29j
  1.03742102e+00+2.46986029e-29j]
HOMO = 0.0289470519499  LUMO = 0.360599765942
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.69634019  0.02894705  0.02894705  0.02894705] [0.36059977 0.92038009 0.9203801  0.9203801  0.93388755 0.93388755
 0.93388755 1.18573414 1.18573414 1.87626244 1.87626244 1.87626244
 2.15923901 2.94606237 2.94606237 2.94606238 4.08812386 4.08812387
 4.08812387 4.20623593 4.22224273 4.22224273]
   1 (-0.000  0.000  0.500)   [-0.67657496 -0.06712761  0.01988783  0.01988783] [0.43033108 0.63778363 0.73622909 0.73622909 1.14507923 1.16426169
 1.16426169 1.5530923  1.63353005 1.63353005 1.68844081 1.68844082
 2.34362406 2.72017494 3.01035613 3.11217875 3.11217876 3.88931857
 3.88931857 4.03256336 4.18547211 4.18547211]
   2 ( 0.000  0.500  0.000)   [-0.67657496 -0.06712761  0.01988783  0.01988783] [0.43033108 0.63778363 0.73622909 0.73622909 1.14507923 1.16426168
 1.16426169 1.5530923  1.63353005 1.63353005 1.68844079 1.68844081
 2.34362406 2.72017494 3.01035613 3.11217873 3.11217875 3.88931857
 3.88931857 4.03256336 4.18547211 4.18547211]
   3 ( 0.000  0.500  0.500)   [-0.66694856 -0.08285047 -0.00821056 -0.00821056] [0.57413568 0.63265039 0.67032183 0.78205069 0.78205069 1.2620816
 1.42364902 1.57282017 1.60767031 1.60767031 1.74116187 1.74116187
 2.43305172 2.51814375 2.51814375 2.63876527 3.98209429 3.98209429
 4.00354156 4.10193115 4.43566565 5.52596929]
   4 ( 0.500 -0.000 -0.000)   [-0.67657496 -0.06712761  0.01988783  0.01988783] [0.43033108 0.63778363 0.73622909 0.73622909 1.14507923 1.16426169
 1.16426169 1.5530923  1.63353005 1.63353005 1.68844079 1.68844081
 2.34362406 2.72017494 3.01035613 3.11217873 3.11217875 3.88931857
 3.88931857 4.03256336 4.18547211 4.18547211]
   5 ( 0.500  0.000  0.500)   [-0.66694856 -0.08285048 -0.00821056 -0.00821055] [0.57413568 0.63265039 0.67032183 0.78205069 0.78205069 1.2620816
 1.42364903 1.57282017 1.60767031 1.60767031 1.74116186 1.74116187
 2.43305172 2.51814375 2.51814375 2.63876527 3.98209428 3.98209429
 4.00354156 4.10193115 4.43566566 5.52596929]
   6 ( 0.500  0.500 -0.000)   [-0.66694856 -0.08285048 -0.00821056 -0.00821055] [0.57413568 0.63265039 0.67032183 0.78205069 0.78205069 1.2620816
 1.42364903 1.57282017 1.60767031 1.60767031 1.74116186 1.74116187
 2.43305172 2.51814375 2.51814375 2.63876527 3.98209428 3.98209429
 4.00354156 4.10193115 4.43566566 5.52596929]
   7 ( 0.500  0.500  0.500)   [-0.67657496 -0.06712761  0.01988783  0.01988783] [0.43033108 0.63778363 0.73622909 0.73622909 1.14507923 1.16426169
 1.16426169 1.5530923  1.63353005 1.63353005 1.6884408  1.68844082
 2.34362406 2.72017494 3.01035613 3.11217874 3.11217876 3.88931857
 3.88931857 4.03256336 4.18547211 4.18547211]
nelec by numeric integration = 7.999999999998829
    CPU time for vxc     45.65 sec, wall time      1.44 sec
    CPU time for get_j pass 1      2.00 sec, wall time      0.06 sec
    CPU time for get_j pass 2      1.70 sec, wall time      0.05 sec
    CPU time for vj and vk      3.95 sec, wall time      0.12 sec
Ewald components = 4.62253161018766e-90, -105.966782880783, 89.9345283064059
E1 = (-12.153660008708965+4.2802099779046147e-29j)  Ecoul = 8.599097149606392  Exc = -4.988457496166647
cycle= 5 E= -24.5752749296467  delta_E= -9.77e-06  |g|= 0.000555  |ddm|= 0.0507
    CPU time for cycle= 5     50.88 sec, wall time      1.60 sec
diis-norm(errvec)=0.000974321
diis-c [-8.78326409e-09-2.80259693e-44j  4.28585683e-05-5.22783139e-31j
 -1.22618538e-05+8.18414264e-32j  7.58442410e-04+2.89940370e-30j
 -3.01441263e-02-1.77551168e-28j  1.02935509e+00+1.75092706e-28j]
HOMO = 0.0289242435596  LUMO = 0.360602268272
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.69636051  0.02892424  0.02892424  0.02892424] [0.36060227 0.92038706 0.92038706 0.92038706 0.93390256 0.93390257
 0.93390257 1.18574185 1.18574185 1.87624873 1.87624873 1.87624873
 2.15924152 2.94606986 2.94606987 2.94606987 4.08810434 4.08810434
 4.08810434 4.20622184 4.22222389 4.22222389]
   1 (-0.000  0.000  0.500)   [-0.67659652 -0.06714283  0.01986545  0.01986545] [0.43033628 0.63777781 0.73624241 0.73624241 1.14508942 1.1642642
 1.1642642  1.55310323 1.63353995 1.63353995 1.68844668 1.68844669
 2.34361897 2.72016569 3.01034475 3.11217119 3.1121712  3.88929831
 3.88929831 4.03254343 4.18545305 4.18545306]
   2 ( 0.000  0.500  0.000)   [-0.67659652 -0.06714283  0.01986545  0.01986545] [0.43033628 0.63777781 0.73624241 0.73624241 1.14508942 1.1642642
 1.1642642  1.55310323 1.63353995 1.63353995 1.68844666 1.68844668
 2.34361897 2.72016569 3.01034475 3.11217117 3.11217119 3.88929831
 3.88929831 4.03254343 4.18545305 4.18545306]
   3 ( 0.000  0.500  0.500)   [-0.66697079 -0.08286417 -0.00823014 -0.00823014] [0.57412949 0.63265333 0.67033259 0.78205646 0.78205646 1.2620864
 1.42365546 1.57283129 1.60767826 1.60767826 1.74117043 1.74117043
 2.43305008 2.51813375 2.51813375 2.63875022 3.98207471 3.98207471
 4.00352139 4.10191191 4.43564801 5.52595884]
   4 ( 0.500 -0.000 -0.000)   [-0.67659652 -0.06714283  0.01986545  0.01986545] [0.43033628 0.63777781 0.73624241 0.73624241 1.14508942 1.1642642
 1.1642642  1.55310323 1.63353995 1.63353995 1.68844666 1.68844668
 2.34361897 2.72016569 3.01034475 3.11217117 3.11217119 3.88929831
 3.88929831 4.03254343 4.18545305 4.18545306]
   5 ( 0.500  0.000  0.500)   [-0.66697079 -0.08286417 -0.00823014 -0.00823014] [0.57412949 0.63265333 0.67033259 0.78205646 0.78205646 1.2620864
 1.42365547 1.57283129 1.60767826 1.60767826 1.74117043 1.74117043
 2.43305008 2.51813374 2.51813375 2.63875022 3.98207471 3.98207471
 4.00352138 4.10191191 4.43564801 5.52595884]
   6 ( 0.500  0.500 -0.000)   [-0.66697079 -0.08286417 -0.00823014 -0.00823014] [0.57412949 0.63265333 0.67033259 0.78205646 0.78205646 1.2620864
 1.42365547 1.57283129 1.60767826 1.60767826 1.74117043 1.74117043
 2.43305008 2.51813374 2.51813375 2.63875022 3.98207471 3.98207471
 4.00352138 4.10191191 4.43564801 5.52595883]
   7 ( 0.500  0.500  0.500)   [-0.67659652 -0.06714283  0.01986545  0.01986545] [0.43033628 0.63777781 0.73624241 0.73624241 1.14508942 1.1642642
 1.1642642  1.55310323 1.63353995 1.63353995 1.68844667 1.68844668
 2.34361897 2.72016569 3.01034475 3.11217118 3.1121712  3.88929831
 3.88929831 4.03254343 4.18545305 4.18545306]
nelec by numeric integration = 7.999999999998827
    CPU time for vxc     45.04 sec, wall time      1.42 sec
    CPU time for get_j pass 1      2.85 sec, wall time      0.09 sec
    CPU time for get_j pass 2      1.30 sec, wall time      0.04 sec
    CPU time for vj and vk      4.28 sec, wall time      0.14 sec
Ewald components = 4.62253161018766e-90, -105.966782880783, 89.9345283064059
E1 = (-12.153938938962094+3.9472522739095553e-29j)  Ecoul = 8.59945465840193  Exc = -4.988536080839567
cycle= 6 E= -24.5752749357772  delta_E= -6.13e-09  |g|= 3.74e-05  |ddm|= 0.00148
    CPU time for cycle= 6     53.26 sec, wall time      1.69 sec
HOMO = 0.0289197045994  LUMO = 0.36060182812
     k-point                  mo_energy
   0 ( 0.000  0.000  0.000)   [-0.69636459  0.0289197   0.0289197   0.0289197 ] [0.36060183 0.92038726 0.92038726 0.92038726 0.93390321 0.93390321
 0.93390321 1.18574178 1.18574178 1.87624564 1.87624564 1.87624564
 2.15924198 2.9460704  2.9460704  2.94607041 4.08810043 4.08810043
 4.08810043 4.20621931 4.22222003 4.22222003]
   1 (-0.000  0.000  0.500)   [-0.67660081 -0.0671461   0.01986099  0.01986099] [0.43033627 0.63777607 0.73624308 0.73624308 1.14509024 1.16426353
 1.16426353 1.55310405 1.63354033 1.63354034 1.68844623 1.68844624
 2.34361817 2.72016345 3.0103429  3.11216877 3.11216878 3.88929433
 3.88929433 4.03253954 4.18544922 4.18544922]
   2 ( 0.000  0.500  0.000)   [-0.67660081 -0.0671461   0.01986099  0.01986099] [0.43033627 0.63777607 0.73624308 0.73624308 1.14509024 1.16426353
 1.16426353 1.55310405 1.63354033 1.63354034 1.68844622 1.68844623
 2.34361817 2.72016345 3.0103429  3.11216875 3.11216877 3.88929433
 3.88929433 4.03253954 4.18544922 4.18544922]
   3 ( 0.000  0.500  0.500)   [-0.66697519 -0.0828672  -0.00823418 -0.00823418] [0.57412762 0.63265371 0.67033289 0.7820559  0.7820559  1.26208581
 1.42365513 1.57283221 1.6076788  1.6076788  1.74117051 1.74117051
 2.43305019 2.51813131 2.51813131 2.63874729 3.98207082 3.98207082
 4.00351743 4.10190812 4.43564425 5.5259562 ]
   4 ( 0.500 -0.000 -0.000)   [-0.67660081 -0.0671461   0.01986099  0.01986099] [0.43033627 0.63777607 0.73624308 0.73624308 1.14509024 1.16426353
 1.16426353 1.55310405 1.63354033 1.63354034 1.68844621 1.68844623
 2.34361817 2.72016345 3.0103429  3.11216875 3.11216877 3.88929433
 3.88929433 4.03253954 4.18544922 4.18544922]
   5 ( 0.500  0.000  0.500)   [-0.66697519 -0.0828672  -0.00823418 -0.00823418] [0.57412762 0.63265371 0.67033289 0.7820559  0.7820559  1.26208581
 1.42365513 1.57283221 1.6076788  1.6076788  1.74117051 1.74117051
 2.43305019 2.51813131 2.51813131 2.63874729 3.98207082 3.98207082
 4.00351743 4.10190812 4.43564425 5.5259562 ]
   6 ( 0.500  0.500 -0.000)   [-0.66697519 -0.0828672  -0.00823418 -0.00823418] [0.57412762 0.63265371 0.67033289 0.7820559  0.7820559  1.26208581
 1.42365513 1.57283221 1.6076788  1.6076788  1.74117051 1.74117051
 2.43305019 2.51813131 2.51813131 2.63874729 3.98207082 3.98207082
 4.00351743 4.10190812 4.43564425 5.5259562 ]
   7 ( 0.500  0.500  0.500)   [-0.67660081 -0.0671461   0.01986099  0.01986099] [0.43033627 0.63777607 0.73624308 0.73624308 1.14509024 1.16426353
 1.16426353 1.55310405 1.63354033 1.63354033 1.68844622 1.68844624
 2.34361817 2.72016345 3.0103429  3.11216876 3.11216878 3.88929433
 3.88929433 4.03253954 4.18544922 4.18544922]
nelec by numeric integration = 7.999999999998827
    CPU time for vxc     43.77 sec, wall time      1.40 sec
    CPU time for get_j pass 1      1.81 sec, wall time      0.06 sec
    CPU time for get_j pass 2      1.71 sec, wall time      0.05 sec
    CPU time for vj and vk      3.77 sec, wall time      0.12 sec
Ewald components = 4.62253161018766e-90, -105.966782880783, 89.9345283064059
E1 = (-12.153985668854027+4.092098971436059e-29j)  Ecoul = 8.599514545689214  Exc = -4.988549238204798
Extra cycle  E= -24.5752749357471  delta_E= 3.01e-11  |g|= 5.46e-05  |ddm|= 0.000236
    CPU time for scf_cycle   5465.49 sec, wall time    282.11 sec
    CPU time for SCF   5465.53 sec, wall time    282.15 sec
converged SCF energy = -24.5752749357471
    CPU time for vnuc pass1: analytic int    177.86 sec, wall time      7.58 sec
    CPU time for contracting Vnuc [0:343]      8.39 sec, wall time      0.31 sec
    CPU time for contracting Vnuc      8.40 sec, wall time      0.31 sec
    CPU time for get_pp_loc_part1    186.26 sec, wall time      7.89 sec
    CPU time for get_pp_loc_part2    280.67 sec, wall time     11.92 sec
    CPU time for get_pp_nl      4.23 sec, wall time      0.65 sec
    CPU time for get_pp    471.16 sec, wall time     20.45 sec
nelec by numeric integration = 7.999999999998823
    CPU time for vxc     74.39 sec, wall time      3.03 sec
    CPU time for get_j pass 1      4.28 sec, wall time      0.15 sec
    CPU time for get_j pass 2      0.02 sec, wall time      0.00 sec
    CPU time for vj and vk      4.57 sec, wall time      0.16 sec
